Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 252.8686876296997
Step 1: Done
inspect_time = 270555.65625
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 54.75281500816345
[run_ginex.py] pass_1_and_2 time = 54.75290131568909
Pass 3: Computing changesets...
Done!
pass_3 time = 186.88865637779236
[run_ginex.py] pass_3 time = 186.88892197608948
[run_ginex.py] sb_sample time = 253.15386748313904
Step 1: Done
inspect_time = 332119.75
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.10937599837779999
gather:  147.3192596435547
cache:  0.04800000041723251
transfer:  165.11619567871094
forward:  309.17437744140625
backward:  218.16114807128906
free:  13.762720108032227
1000
sampling:  0.04233599826693535
gather:  0.023135999217629433
cache:  0.019168000668287277
transfer:  21.669471740722656
forward:  2.1394879817962646
backward:  1.3742079734802246
free:  0.21539199352264404
2000
sampling:  0.2881920039653778
gather:  65.22755432128906
cache:  0.12223999947309494
transfer:  22.895008087158203
forward:  2.4709761142730713
backward:  2.8825600147247314
free:  0.30556800961494446
3000
sampling:  0.160288006067276
gather:  42.428382873535156
cache:  0.09945599734783173
transfer:  23.578655242919922
forward:  2.5120959281921387
backward:  2.092031955718994
free:  0.2911039888858795
4000
sampling:  0.2311680018901825
gather:  46.806785583496094
cache:  1.1053760051727295
transfer:  20.900575637817383
forward:  2.577888011932373
backward:  5.227519989013672
free:  0.7767360210418701
5000
sampling:  0.3306240141391754
gather:  46.1798095703125
cache:  0.09625600278377533
transfer:  22.87740707397461
forward:  2.493056058883667
backward:  2.1340160369873047
free:  0.3091840147972107
6000
sampling:  0.3062399923801422
gather:  35.31782531738281
cache:  0.29183998703956604
transfer:  22.339168548583984
forward:  2.600032091140747
backward:  2.358272075653076
free:  0.3293440043926239
7000
sampling:  0.3267199993133545
gather:  41.262718200683594
cache:  1.2030080556869507
transfer:  27.51411247253418
forward:  2.8348801136016846
backward:  2.8118720054626465
free:  0.34351998567581177
8000
sampling:  0.14860799908638
gather:  46.25222396850586
cache:  0.08345600217580795
transfer:  21.203296661376953
forward:  2.4901440143585205
backward:  6.339583873748779
free:  0.7400959730148315
9000
sampling:  0.42211198806762695
gather:  43.11830520629883
cache:  0.06265600025653839
transfer:  23.07094383239746
forward:  2.5348479747772217
backward:  2.322432041168213
free:  0.306304007768631
10000
sampling:  0.377375990152359
gather:  33.12063980102539
cache:  0.032287999987602234
transfer:  24.904800415039062
forward:  2.5264320373535156
backward:  1.5912959575653076
free:  0.2287999987602234
11000
sampling:  0.27555200457572937
gather:  37.938079833984375
cache:  0.0759039968252182
transfer:  31.988191604614258
forward:  2.3649280071258545
backward:  1.7223680019378662
free:  0.23449599742889404
12000
sampling:  0.3044480085372925
gather:  35.76652908325195
cache:  0.20399999618530273
transfer:  22.197824478149414
forward:  2.5050559043884277
backward:  2.013184070587158
free:  0.3075200021266937
13000
sampling:  0.33212798833847046
gather:  38.260257720947266
cache:  0.10534399747848511
transfer:  24.589567184448242
forward:  2.9608640670776367
backward:  3.753983974456787
free:  0.2805759906768799
14000
sampling:  0.2077759951353073
gather:  44.13727951049805
cache:  0.16223999857902527
transfer:  29.583232879638672
forward:  2.66540789604187
backward:  2.1197121143341064
free:  0.22735999524593353
15000
sampling:  0.2099200040102005
gather:  40.74099349975586
cache:  0.17417599260807037
transfer:  22.07529640197754
forward:  2.7867839336395264
backward:  7.261184215545654
free:  0.3080640137195587
16000
sampling:  0.28780800104141235
gather:  40.584415435791016
cache:  0.12723200023174286
transfer:  23.977632522583008
forward:  2.4771840572357178
backward:  2.1862399578094482
free:  0.30774399638175964
17000
sampling:  0.27983999252319336
gather:  46.195743560791016
cache:  0.07660800218582153
transfer:  30.005311965942383
forward:  2.3952319622039795
backward:  3.2184319496154785
free:  0.3580799996852875
18000
sampling:  0.25603199005126953
gather:  38.19228744506836
cache:  0.25756800174713135
transfer:  26.148479461669922
forward:  2.415584087371826
backward:  1.6885759830474854
free:  0.24982400238513947
19000
sampling:  0.14502400159835815
gather:  40.293182373046875
cache:  0.21779200434684753
transfer:  24.830720901489258
forward:  2.4872000217437744
backward:  1.8483200073242188
free:  0.2120320051908493
20000
sampling:  0.23734399676322937
gather:  37.36857604980469
cache:  0.07542400062084198
transfer:  23.47212791442871
forward:  2.6262080669403076
backward:  2.337791919708252
free:  0.33555200695991516
21000
sampling:  0.2574720084667206
gather:  38.31167984008789
cache:  0.44867199659347534
transfer:  34.04822540283203
forward:  2.310175895690918
backward:  1.4796799421310425
free:  0.2287680059671402
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: False, khop: 12
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
252.8687
253.1539
54.7529
186.8889
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
332.1198
85.8354
5.6893
929.8139
30.0963
526.9172
57.7945
56.6736
154.6227
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0002, Approx. Train: 0.8643
Epoch time: 2521911.4957 ms
