Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 251.5760736465454
Step 1: Done
inspect_time = 269254.84375
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 52.63574266433716
[run_ginex.py] pass_1_and_2 time = 52.635796546936035
Pass 3: Computing changesets...
Done!
pass_3 time = 220.30114436149597
[run_ginex.py] pass_3 time = 220.3017876148224
[run_ginex.py] sb_sample time = 286.8505046367645
Step 1: Done
inspect_time = 363961.21875
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.09510400146245956
gather:  136.74330139160156
cache:  0.04012800008058548
transfer:  169.602783203125
forward:  293.83380126953125
backward:  243.85638427734375
free:  19.31372833251953
1000
sampling:  0.327455997467041
gather:  0.5413119792938232
cache:  0.06415999680757523
transfer:  28.00908851623535
forward:  2.4214720726013184
backward:  2.1975040435791016
free:  0.2535359859466553
2000
sampling:  0.2672320008277893
gather:  58.25715255737305
cache:  0.07664000242948532
transfer:  22.16655921936035
forward:  2.6557440757751465
backward:  2.662400007247925
free:  0.30611199140548706
3000
sampling:  0.2686080038547516
gather:  49.98566436767578
cache:  0.6138560175895691
transfer:  22.17203140258789
forward:  2.4489920139312744
backward:  2.6306560039520264
free:  0.3049280047416687
4000
sampling:  0.3770880103111267
gather:  41.759521484375
cache:  0.06067200005054474
transfer:  24.421791076660156
forward:  2.4527039527893066
backward:  1.9527679681777954
free:  0.2794559895992279
5000
sampling:  0.4429120123386383
gather:  31.669408798217773
cache:  0.026048000901937485
transfer:  21.343040466308594
forward:  2.361056089401245
backward:  2.1821439266204834
free:  0.23852799832820892
6000
sampling:  0.5234559774398804
gather:  41.380126953125
cache:  0.05430399999022484
transfer:  21.277599334716797
forward:  2.6022400856018066
backward:  7.631872177124023
free:  0.42531201243400574
7000
sampling:  0.35305601358413696
gather:  48.86934280395508
cache:  0.1467200070619583
transfer:  23.578048706054688
forward:  2.538111925125122
backward:  3.6116480827331543
free:  1.5551999807357788
8000
sampling:  0.37164801359176636
gather:  41.0596809387207
cache:  0.06511999666690826
transfer:  24.664640426635742
forward:  2.4413440227508545
backward:  1.8206720352172852
free:  0.2417600005865097
9000
sampling:  0.26796799898147583
gather:  42.107200622558594
cache:  0.061055999249219894
transfer:  24.70150375366211
forward:  2.3732800483703613
backward:  1.7571840286254883
free:  0.22208000719547272
10000
sampling:  0.2820799946784973
gather:  34.69331359863281
cache:  0.06950400024652481
transfer:  24.7608642578125
forward:  2.446943998336792
backward:  1.556480050086975
free:  0.2261440008878708
11000
sampling:  0.14425599575042725
gather:  36.46566390991211
cache:  0.026623999699950218
transfer:  20.436800003051758
forward:  2.489856004714966
backward:  2.726912021636963
free:  0.41312000155448914
12000
sampling:  0.1356160044670105
gather:  39.09427261352539
cache:  0.04182400181889534
transfer:  21.037567138671875
forward:  2.4366719722747803
backward:  2.465791940689087
free:  0.2793920040130615
13000
sampling:  0.29423999786376953
gather:  45.18297576904297
cache:  0.06998399645090103
transfer:  24.55254364013672
forward:  2.5343680381774902
backward:  1.7991679906845093
free:  0.2134079933166504
14000
sampling:  0.28271999955177307
gather:  39.13443374633789
cache:  0.2617279887199402
transfer:  24.540992736816406
forward:  2.5322558879852295
backward:  1.7889280319213867
free:  0.24195200204849243
15000
sampling:  0.23071999847888947
gather:  39.68156814575195
cache:  0.1438719928264618
transfer:  25.318368911743164
forward:  2.8445119857788086
backward:  2.605056047439575
free:  0.28547200560569763
16000
sampling:  0.3529599905014038
gather:  42.25465774536133
cache:  0.07811199873685837
transfer:  22.930431365966797
forward:  2.6243839263916016
backward:  5.108736038208008
free:  0.39558398723602295
17000
sampling:  0.21913599967956543
gather:  45.484737396240234
cache:  0.03481600061058998
transfer:  21.924800872802734
forward:  2.5806078910827637
backward:  2.4350719451904297
free:  0.2782079875469208
18000
sampling:  0.28492799401283264
gather:  43.80723190307617
cache:  0.09654399752616882
transfer:  23.614303588867188
forward:  2.732800006866455
backward:  2.982912063598633
free:  0.3003840148448944
19000
sampling:  0.17679999768733978
gather:  38.15727996826172
cache:  0.5735039710998535
transfer:  22.469215393066406
forward:  2.4133760929107666
backward:  2.1032960414886475
free:  0.2630079984664917
20000
sampling:  0.3431360125541687
gather:  45.6478385925293
cache:  0.06464000046253204
transfer:  22.0467529296875
forward:  2.490623950958252
backward:  2.748415946960449
free:  0.3126719892024994
21000
sampling:  0.27987200021743774
gather:  44.18364715576172
cache:  0.09683199971914291
transfer:  23.845279693603516
forward:  2.527071952819824
backward:  2.7392001152038574
free:  0.31094399094581604
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: False, khop: 8
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
251.6
286.9
52.6
220.3
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
363.9612
88.8601
5.6934
923.7648
32.3259
531.5100
56.4604
55.5519
145.1249
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0002, Approx. Train: 0.8643
Epoch time: 2545420.1012 ms
