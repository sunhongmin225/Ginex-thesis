Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 250.5990538597107
Step 1: Done
inspect_time = 268284.53125
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 50.523062229156494
[run_ginex.py] pass_1_and_2 time = 50.52312660217285
Pass 3: Computing changesets...
Done!
pass_3 time = 841.226155757904
[run_ginex.py] pass_3 time = 841.2265572547913
[run_ginex.py] sb_sample time = 906.917635679245
Step 1: Done
inspect_time = 981477.625
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.09759999811649323
gather:  153.340576171875
cache:  0.03855999931693077
transfer:  203.17575073242188
forward:  263.34442138671875
backward:  272.6697082519531
free:  24.147552490234375
1000
sampling:  0.5998719930648804
gather:  0.39401599764823914
cache:  0.015168000012636185
transfer:  21.39904022216797
forward:  2.075648069381714
backward:  1.5482879877090454
free:  0.22339199483394623
2000
sampling:  0.29414400458335876
gather:  71.39513397216797
cache:  0.4362559914588928
transfer:  24.861696243286133
forward:  2.432703971862793
backward:  2.3572158813476562
free:  0.29600000381469727
3000
sampling:  0.25753599405288696
gather:  50.552734375
cache:  0.07939200103282928
transfer:  24.805503845214844
forward:  3.195807933807373
backward:  2.3367679119110107
free:  0.3158079981803894
4000
sampling:  0.17820799350738525
gather:  41.63737487792969
cache:  0.1809920072555542
transfer:  23.269920349121094
forward:  2.529344081878662
backward:  2.6859519481658936
free:  0.30720001459121704
5000
sampling:  1.1071360111236572
gather:  36.54713439941406
cache:  0.03347200155258179
transfer:  33.595008850097656
forward:  2.4832639694213867
backward:  1.6752640008926392
free:  0.19487999379634857
6000
sampling:  0.2622399926185608
gather:  36.72848129272461
cache:  0.06355199962854385
transfer:  24.343551635742188
forward:  2.251296043395996
backward:  1.5226880311965942
free:  0.21980799734592438
7000
sampling:  0.23881599307060242
gather:  44.895809173583984
cache:  0.06518399715423584
transfer:  23.90812873840332
forward:  2.5728321075439453
backward:  2.6818559169769287
free:  0.3290880024433136
8000
sampling:  0.4713920056819916
gather:  42.7380485534668
cache:  0.12707200646400452
transfer:  23.258975982666016
forward:  2.490528106689453
backward:  2.7402238845825195
free:  0.29660800099372864
9000
sampling:  0.5022720098495483
gather:  38.18931198120117
cache:  0.06841599941253662
transfer:  23.2893123626709
forward:  2.6042559146881104
backward:  2.1719040870666504
free:  0.2657279968261719
10000
sampling:  0.3420160114765167
gather:  38.04003143310547
cache:  0.06124800071120262
transfer:  24.450016021728516
forward:  2.4362881183624268
backward:  1.7643519639968872
free:  0.24499200284481049
11000
sampling:  0.15769599378108978
gather:  49.91836929321289
cache:  0.12595200538635254
transfer:  31.46396827697754
forward:  3.0887680053710938
backward:  2.539520025253296
free:  0.3152639865875244
12000
sampling:  0.22326399385929108
gather:  43.266014099121094
cache:  0.06364800035953522
transfer:  23.92563247680664
forward:  2.506848096847534
backward:  1.627135992050171
free:  0.21555200219154358
13000
sampling:  0.21724799275398254
gather:  50.724449157714844
cache:  0.08585599809885025
transfer:  21.886720657348633
forward:  2.692960023880005
backward:  4.7790398597717285
free:  0.3447040021419525
14000
sampling:  0.9732800126075745
gather:  39.46527862548828
cache:  0.05129599943757057
transfer:  23.30156707763672
forward:  2.4300479888916016
backward:  1.6906239986419678
free:  0.25142401456832886
15000
sampling:  0.4131839871406555
gather:  33.739166259765625
cache:  0.0344959981739521
transfer:  22.756256103515625
forward:  2.4681599140167236
backward:  2.2415359020233154
free:  0.2574079930782318
16000
sampling:  0.3195520043373108
gather:  45.20608139038086
cache:  0.10992000252008438
transfer:  25.77952003479004
forward:  2.3649919033050537
backward:  1.6578559875488281
free:  0.22815999388694763
17000
sampling:  0.34694400429725647
gather:  40.202335357666016
cache:  0.03686400130391121
transfer:  22.652767181396484
forward:  2.6534719467163086
backward:  3.0402560234069824
free:  0.30694401264190674
18000
sampling:  0.23126399517059326
gather:  40.640865325927734
cache:  0.07795199751853943
transfer:  24.3919677734375
forward:  2.497472047805786
backward:  1.8626559972763062
free:  0.25916799902915955
19000
sampling:  0.26764801144599915
gather:  41.47612762451172
cache:  0.12099199742078781
transfer:  24.771072387695312
forward:  2.3412160873413086
backward:  1.5196160078048706
free:  0.2282239943742752
20000
sampling:  0.24432000517845154
gather:  41.04383850097656
cache:  0.11974400281906128
transfer:  22.120384216308594
forward:  2.4151360988616943
backward:  2.8334081172943115
free:  0.3010239899158478
21000
sampling:  0.229312002658844
gather:  49.04383850097656
cache:  0.1720000058412552
transfer:  23.272703170776367
forward:  2.6467840671539307
backward:  2.318336009979248
free:  0.2837119996547699
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: False, khop: 2
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
250.6
906.9
50.5
841.2
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
981.4776
90.3509
5.0332
927.3950
48.8155
513.0249
55.6225
54.3156
128.0158
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0002, Approx. Train: 0.8643
Epoch time: 3165722.6167 ms
