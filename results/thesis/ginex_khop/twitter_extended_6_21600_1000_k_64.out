Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 250.09412956237793
Step 1: Done
inspect_time = 267746.59375
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 66.90621781349182
[run_ginex.py] pass_1_and_2 time = 66.90629029273987
Pass 3: Computing changesets...
Done!
pass_3 time = 146.84388828277588
[run_ginex.py] pass_3 time = 146.8442702293396
[run_ginex.py] sb_sample time = 211.76461458206177
Step 1: Done
inspect_time = 303616.625
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.1074879989027977
gather:  150.81881713867188
cache:  0.039583999663591385
transfer:  148.41229248046875
forward:  334.0302734375
backward:  209.87904357910156
free:  12.880064010620117
1000
sampling:  0.0469760000705719
gather:  0.04297599941492081
cache:  0.025728000327944756
transfer:  22.416576385498047
forward:  1.9976320266723633
backward:  1.1632640361785889
free:  0.22918400168418884
2000
sampling:  0.2927680015563965
gather:  61.70380783081055
cache:  0.08230400085449219
transfer:  24.928224563598633
forward:  2.4672958850860596
backward:  2.371583938598633
free:  0.2898240089416504
3000
sampling:  0.32793599367141724
gather:  50.47148895263672
cache:  0.25763198733329773
transfer:  24.72153663635254
forward:  2.4903039932250977
backward:  2.6112000942230225
free:  0.31062400341033936
4000
sampling:  0.2699519991874695
gather:  37.09894561767578
cache:  0.07699199765920639
transfer:  23.379680633544922
forward:  2.502847909927368
backward:  3.0361599922180176
free:  0.4033600091934204
5000
sampling:  0.20361599326133728
gather:  37.73942565917969
cache:  0.06707199662923813
transfer:  25.253568649291992
forward:  2.5070719718933105
backward:  1.8974720239639282
free:  0.18428799510002136
6000
sampling:  0.16771200299263
gather:  46.69232177734375
cache:  0.10838399827480316
transfer:  20.318368911743164
forward:  2.4718399047851562
backward:  1.9466240406036377
free:  0.298335999250412
7000
sampling:  1.4025280475616455
gather:  46.13343811035156
cache:  0.10364799946546555
transfer:  25.48419189453125
forward:  2.423935890197754
backward:  1.8350080251693726
free:  0.2658880054950714
8000
sampling:  0.12985600531101227
gather:  26.050432205200195
cache:  0.027615999802947044
transfer:  24.03094482421875
forward:  2.322240114212036
backward:  1.5431679487228394
free:  0.23315200209617615
9000
sampling:  0.15663999319076538
gather:  51.35424041748047
cache:  0.05027199909090996
transfer:  24.492895126342773
forward:  2.4837119579315186
backward:  2.0183041095733643
free:  0.2032960057258606
10000
sampling:  0.6196159720420837
gather:  42.34761428833008
cache:  0.14777599275112152
transfer:  22.875423431396484
forward:  2.729055881500244
backward:  3.2767999172210693
free:  0.4042559862136841
11000
sampling:  0.14841599762439728
gather:  45.39081573486328
cache:  0.08444800227880478
transfer:  23.608383178710938
forward:  2.5161919593811035
backward:  3.601408004760742
free:  0.30748799443244934
12000
sampling:  0.21216000616550446
gather:  42.35683059692383
cache:  0.07308799773454666
transfer:  21.860767364501953
forward:  2.598560094833374
backward:  4.526080131530762
free:  0.9730560183525085
13000
sampling:  0.2712959945201874
gather:  47.336448669433594
cache:  0.4338560104370117
transfer:  25.681791305541992
forward:  2.3932480812072754
backward:  1.7817280292510986
free:  0.25436800718307495
14000
sampling:  0.1610880047082901
gather:  44.74540710449219
cache:  0.3031040132045746
transfer:  28.62179183959961
forward:  2.393183946609497
backward:  3.2716801166534424
free:  0.358240008354187
15000
sampling:  0.1955520063638687
gather:  42.19059371948242
cache:  0.04608000069856644
transfer:  24.874048233032227
forward:  2.531935930252075
backward:  1.802240014076233
free:  0.23334400355815887
16000
sampling:  0.133215993642807
gather:  27.65519905090332
cache:  0.028384000062942505
transfer:  20.559263229370117
forward:  2.454047918319702
backward:  3.0269439220428467
free:  0.3770560026168823
17000
sampling:  0.18118399381637573
gather:  39.57494354248047
cache:  0.03014400042593479
transfer:  25.241376876831055
forward:  2.5448639392852783
backward:  1.6680959463119507
free:  0.23097600042819977
18000
sampling:  0.2107200026512146
gather:  40.34902572631836
cache:  0.15030400454998016
transfer:  23.807071685791016
forward:  2.5012478828430176
backward:  2.011136054992676
free:  0.30985599756240845
19000
sampling:  0.30377599596977234
gather:  39.63334274291992
cache:  0.06137600168585777
transfer:  24.637792587280273
forward:  2.5315520763397217
backward:  2.687999963760376
free:  0.3112959861755371
20000
sampling:  0.27395200729370117
gather:  41.56886291503906
cache:  0.0772159993648529
transfer:  24.039583206176758
forward:  2.678431987762451
backward:  3.417088031768799
free:  0.3800640106201172
21000
sampling:  0.15600000321865082
gather:  44.459903717041016
cache:  0.05116799846291542
transfer:  29.50998306274414
forward:  2.5551679134368896
backward:  1.8503680229187012
free:  0.2298559993505478
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: False, khop: 64
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
250.1
211.8
66.9
146.8
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
303.6166
81.5027
6.4682
932.8260
25.6238
540.9494
57.2090
52.5851
120.7710
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0002, Approx. Train: 0.8643
Epoch time: 2461690.4931 ms
