Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 249.04030418395996
Step 1: Done
inspect_time = 266709.34375
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 53.926671743392944
[run_ginex.py] pass_1_and_2 time = 53.92675518989563
Pass 3: Computing changesets...
Done!
pass_3 time = 177.7739109992981
[run_ginex.py] pass_3 time = 177.77425050735474
[run_ginex.py] sb_sample time = 244.5973620414734
Step 1: Done
inspect_time = 322844.53125
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.095551997423172
gather:  195.482177734375
cache:  0.043296001851558685
transfer:  199.95516967773438
forward:  356.4491271972656
backward:  245.96070861816406
free:  16.376352310180664
1000
sampling:  0.032287999987602234
gather:  0.01648000068962574
cache:  0.009983999654650688
transfer:  21.311487197875977
forward:  1.9960639476776123
backward:  1.1581439971923828
free:  0.15465599298477173
2000
sampling:  0.2535040080547333
gather:  56.51878356933594
cache:  0.0679360032081604
transfer:  23.456192016601562
forward:  2.474015951156616
backward:  5.14358377456665
free:  0.4177280068397522
3000
sampling:  0.2215999960899353
gather:  43.891998291015625
cache:  0.08246400207281113
transfer:  21.60358428955078
forward:  2.5927679538726807
backward:  3.9628798961639404
free:  0.2924799919128418
4000
sampling:  0.47567999362945557
gather:  38.841854095458984
cache:  0.06595200300216675
transfer:  23.506336212158203
forward:  2.781599998474121
backward:  2.0346879959106445
free:  0.3158079981803894
5000
sampling:  0.6059839725494385
gather:  34.33635330200195
cache:  1.1629760265350342
transfer:  24.525663375854492
forward:  2.4396800994873047
backward:  1.8636800050735474
free:  0.2420479953289032
6000
sampling:  0.25014400482177734
gather:  40.280513763427734
cache:  0.07769600301980972
transfer:  24.38547134399414
forward:  2.4171841144561768
backward:  2.3306241035461426
free:  0.2869440019130707
7000
sampling:  0.30345600843429565
gather:  43.420127868652344
cache:  0.07212799787521362
transfer:  21.151744842529297
forward:  2.4328958988189697
backward:  4.0663042068481445
free:  0.4818879961967468
8000
sampling:  0.1311360001564026
gather:  47.34092712402344
cache:  0.1225920021533966
transfer:  31.428863525390625
forward:  2.705535888671875
backward:  1.8339840173721313
free:  0.2770879864692688
9000
sampling:  0.6796159744262695
gather:  45.10483169555664
cache:  0.06675200164318085
transfer:  22.447200775146484
forward:  2.4859840869903564
backward:  2.1985280513763428
free:  0.3193280100822449
10000
sampling:  0.1916159987449646
gather:  40.18531036376953
cache:  0.04912000149488449
transfer:  22.402719497680664
forward:  2.521728038787842
backward:  2.43503999710083
free:  0.29337599873542786
11000
sampling:  0.17020800709724426
gather:  49.654048919677734
cache:  0.12412799894809723
transfer:  24.29916763305664
forward:  2.6657280921936035
backward:  2.011136054992676
free:  0.25305598974227905
12000
sampling:  0.1719679981470108
gather:  50.04684829711914
cache:  0.08220800012350082
transfer:  23.86422348022461
forward:  3.0258240699768066
backward:  7.132160186767578
free:  0.5241600275039673
13000
sampling:  0.3370240032672882
gather:  54.29033660888672
cache:  0.07814399898052216
transfer:  25.96326446533203
forward:  2.50982403755188
backward:  1.6332800388336182
free:  0.230880007147789
14000
sampling:  0.25542399287223816
gather:  40.91766357421875
cache:  0.2577599883079529
transfer:  24.338464736938477
forward:  2.597951889038086
backward:  2.270240068435669
free:  0.21532799303531647
15000
sampling:  0.14371199905872345
gather:  38.032928466796875
cache:  0.07148800045251846
transfer:  23.460351943969727
forward:  2.5085439682006836
backward:  2.6060800552368164
free:  0.32598400115966797
16000
sampling:  0.23996800184249878
gather:  51.52774429321289
cache:  0.05008000135421753
transfer:  23.81804847717285
forward:  2.535072088241577
backward:  2.4698879718780518
free:  0.29177600145339966
17000
sampling:  0.2592639923095703
gather:  42.677215576171875
cache:  0.20112000405788422
transfer:  24.43987274169922
forward:  2.5456318855285645
backward:  2.668544054031372
free:  0.32044801115989685
18000
sampling:  0.29097598791122437
gather:  56.37984085083008
cache:  0.06374400109052658
transfer:  22.49692726135254
forward:  2.6343040466308594
backward:  5.089280128479004
free:  1.040287971496582
19000
sampling:  0.1438080072402954
gather:  54.103233337402344
cache:  0.4798400104045868
transfer:  21.086015701293945
forward:  2.509984016418457
backward:  2.2374401092529297
free:  0.3338559865951538
20000
sampling:  0.2937279939651489
gather:  45.4488639831543
cache:  1.2875839471817017
transfer:  25.24995231628418
forward:  2.3605759143829346
backward:  1.6394239664077759
free:  0.23238399624824524
21000
sampling:  0.37487998604774475
gather:  37.45110321044922
cache:  0.054655998945236206
transfer:  29.589855194091797
forward:  2.4949440956115723
backward:  1.7233920097351074
free:  0.30716800689697266
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: False, khop: 14
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
249.0403
244.5974
53.9268
177.7743
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
322.8445
88.0099
5.6961
933.1350
29.0721
526.5257
57.2087
56.5166
155.8108
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0002, Approx. Train: 0.8643
Epoch time: 2512204.9510 ms
