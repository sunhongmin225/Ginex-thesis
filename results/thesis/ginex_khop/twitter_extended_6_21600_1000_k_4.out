Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 249.14890122413635
Step 1: Done
inspect_time = 266833.59375
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 51.849684953689575
[run_ginex.py] pass_1_and_2 time = 51.849772691726685
Pass 3: Computing changesets...
Done!
pass_3 time = 328.3099570274353
[run_ginex.py] pass_3 time = 328.31026816368103
[run_ginex.py] sb_sample time = 394.91209292411804
Step 1: Done
inspect_time = 470522.3125
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.09136000275611877
gather:  210.17135620117188
cache:  0.038336001336574554
transfer:  211.91561889648438
forward:  298.9677734375
backward:  243.2665557861328
free:  14.9552001953125
1000
sampling:  0.043168000876903534
gather:  0.025760000571608543
cache:  0.010304000228643417
transfer:  23.08153533935547
forward:  2.0184319019317627
backward:  1.3301759958267212
free:  0.16921600699424744
2000
sampling:  0.1380160003900528
gather:  56.620384216308594
cache:  0.1364160031080246
transfer:  26.442752838134766
forward:  2.459264039993286
backward:  2.5118401050567627
free:  0.34492799639701843
3000
sampling:  0.1470080018043518
gather:  60.648929595947266
cache:  0.1584320068359375
transfer:  27.61452865600586
forward:  2.4739840030670166
backward:  2.406399965286255
free:  0.323199987411499
4000
sampling:  0.5207679867744446
gather:  40.934112548828125
cache:  0.0544000007212162
transfer:  31.61577606201172
forward:  3.1639039516448975
backward:  1.7131520509719849
free:  0.23004800081253052
5000
sampling:  0.2977280020713806
gather:  38.71977615356445
cache:  0.14531199634075165
transfer:  24.7774715423584
forward:  2.5056960582733154
backward:  2.578432083129883
free:  0.27699199318885803
6000
sampling:  0.31244799494743347
gather:  31.447328567504883
cache:  0.1151999980211258
transfer:  26.414623260498047
forward:  2.644320011138916
backward:  1.7274880409240723
free:  0.24636800587177277
7000
sampling:  0.2512640058994293
gather:  46.26192092895508
cache:  0.08579199761152267
transfer:  24.849184036254883
forward:  2.622368097305298
backward:  6.045695781707764
free:  0.5746880173683167
8000
sampling:  0.1964160054922104
gather:  43.122398376464844
cache:  0.08463999629020691
transfer:  26.334880828857422
forward:  2.510143995285034
backward:  1.5790400505065918
free:  0.22595199942588806
9000
sampling:  0.262688010931015
gather:  40.445953369140625
cache:  0.20739200711250305
transfer:  23.916288375854492
forward:  2.470463991165161
backward:  3.2419838905334473
free:  0.4002560079097748
10000
sampling:  0.3086079955101013
gather:  37.035423278808594
cache:  0.11334399878978729
transfer:  24.44291114807129
forward:  2.678976058959961
backward:  2.9777920246124268
free:  0.3377920091152191
11000
sampling:  0.2856000065803528
gather:  53.351295471191406
cache:  0.09113600105047226
transfer:  28.683168411254883
forward:  3.4897921085357666
backward:  3.5235838890075684
free:  0.28515198826789856
12000
sampling:  0.27142399549484253
gather:  135.13623046875
cache:  0.0666240006685257
transfer:  29.74163246154785
forward:  2.354016065597534
backward:  2.2906880378723145
free:  0.2579840123653412
13000
sampling:  0.5489599704742432
gather:  44.01465606689453
cache:  0.10012800246477127
transfer:  25.96339225769043
forward:  3.161695957183838
backward:  1.691648006439209
free:  0.22284799814224243
14000
sampling:  0.2592960000038147
gather:  36.62636947631836
cache:  1.0557119846343994
transfer:  26.999679565429688
forward:  2.4480319023132324
backward:  2.296799898147583
free:  0.30902400612831116
15000
sampling:  0.15804800391197205
gather:  37.85785675048828
cache:  0.05516799911856651
transfer:  24.848703384399414
forward:  2.368864059448242
backward:  1.7530879974365234
free:  0.248416006565094
16000
sampling:  0.23552000522613525
gather:  41.25846481323242
cache:  1.0629119873046875
transfer:  25.609567642211914
forward:  2.4187839031219482
backward:  1.8647040128707886
free:  0.27539199590682983
17000
sampling:  0.29628801345825195
gather:  43.85558319091797
cache:  0.8617280125617981
transfer:  24.720928192138672
forward:  2.5028159618377686
backward:  3.5880959033966064
free:  0.3687039911746979
18000
sampling:  0.35123199224472046
gather:  44.78335952758789
cache:  0.0960640013217926
transfer:  31.07993507385254
forward:  4.2363200187683105
backward:  2.2650880813598633
free:  0.3171519935131073
19000
sampling:  0.4362879991531372
gather:  37.98982238769531
cache:  0.06703999638557434
transfer:  26.302080154418945
forward:  2.315743923187256
backward:  1.56876802444458
free:  0.22489599883556366
20000
sampling:  0.1804479956626892
gather:  33.625022888183594
cache:  0.8316479921340942
transfer:  24.924224853515625
forward:  2.5697920322418213
backward:  1.9967999458312988
free:  0.2882879972457886
21000
sampling:  0.31756800413131714
gather:  38.9780158996582
cache:  0.31033599376678467
transfer:  24.972959518432617
forward:  2.4853758811950684
backward:  2.126847982406616
free:  0.2051839977502823
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: False, khop: 4
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
249.1
394.9
51.8
328.3
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
470.5223
88.0751
5.6732
910.9607
39.5211
554.8167
55.3803
51.6827
129.6143
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0002, Approx. Train: 0.8643
Epoch time: 2652125.7501 ms
