Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 249.16165614128113
Step 1: Done
inspect_time = 266805.125
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 52.90578556060791
[run_ginex.py] pass_1_and_2 time = 52.905834674835205
Pass 3: Computing changesets...
Done!
pass_3 time = 199.98666524887085
[run_ginex.py] pass_3 time = 199.98724603652954
[run_ginex.py] sb_sample time = 266.8510055541992
Step 1: Done
inspect_time = 344518.25
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.09113600105047226
gather:  194.49615478515625
cache:  0.04227200150489807
transfer:  160.9692840576172
forward:  348.3531494140625
backward:  218.5482177734375
free:  14.82703971862793
1000
sampling:  0.06627199798822403
gather:  1.980672001838684
cache:  0.011071999557316303
transfer:  24.096256256103516
forward:  2.1616640090942383
backward:  1.307647943496704
free:  0.19302399456501007
2000
sampling:  0.25488001108169556
gather:  65.26707458496094
cache:  0.12080000340938568
transfer:  24.15305519104004
forward:  2.639967918395996
backward:  2.654207944869995
free:  0.2987520098686218
3000
sampling:  0.2738560140132904
gather:  40.8625602722168
cache:  0.5702080130577087
transfer:  21.982528686523438
forward:  2.4372479915618896
backward:  3.4406399726867676
free:  0.4615679979324341
4000
sampling:  0.7514879703521729
gather:  34.379295349121094
cache:  0.0352960005402565
transfer:  22.19059181213379
forward:  2.5229439735412598
backward:  2.950144052505493
free:  0.3283520042896271
5000
sampling:  0.24463999271392822
gather:  39.03366470336914
cache:  0.22431999444961548
transfer:  24.672000885009766
forward:  2.570496082305908
backward:  2.7054080963134766
free:  0.2535359859466553
6000
sampling:  0.2393919974565506
gather:  38.78246307373047
cache:  0.04761600121855736
transfer:  33.09008026123047
forward:  2.2326719760894775
backward:  1.4479360580444336
free:  0.19219200313091278
7000
sampling:  0.29260799288749695
gather:  42.92041778564453
cache:  0.08044800162315369
transfer:  23.887903213500977
forward:  2.473504066467285
backward:  2.745311975479126
free:  0.35363200306892395
8000
sampling:  0.32022398710250854
gather:  43.73571014404297
cache:  0.06883200258016586
transfer:  25.89094352722168
forward:  2.563551902770996
backward:  1.9845119714736938
free:  0.21747200191020966
9000
sampling:  0.2385919988155365
gather:  38.000736236572266
cache:  0.21772800385951996
transfer:  24.504064559936523
forward:  2.5899200439453125
backward:  1.87391996383667
free:  0.22470399737358093
10000
sampling:  0.32838401198387146
gather:  40.467777252197266
cache:  0.5960639715194702
transfer:  30.55366325378418
forward:  3.1277120113372803
backward:  2.144256114959717
free:  0.2502720057964325
11000
sampling:  0.28707200288772583
gather:  45.82831954956055
cache:  0.08528000116348267
transfer:  24.972639083862305
forward:  2.5936319828033447
backward:  1.9701759815216064
free:  0.22758400440216064
12000
sampling:  0.24953599274158478
gather:  43.571231842041016
cache:  0.08268799632787704
transfer:  25.18182373046875
forward:  2.5198400020599365
backward:  3.180543899536133
free:  0.32419198751449585
13000
sampling:  0.09811200201511383
gather:  33.24528121948242
cache:  0.0208320003002882
transfer:  18.6911678314209
forward:  2.393951892852783
backward:  2.4688639640808105
free:  0.2520959973335266
14000
sampling:  0.3819519877433777
gather:  36.006431579589844
cache:  0.11231999844312668
transfer:  24.57721519470215
forward:  2.5251519680023193
backward:  1.6465920209884644
free:  0.22115199267864227
15000
sampling:  0.2611840069293976
gather:  40.44153594970703
cache:  0.11999999731779099
transfer:  25.975807189941406
forward:  2.4914560317993164
backward:  2.4668478965759277
free:  0.298880010843277
16000
sampling:  0.31622400879859924
gather:  43.87974548339844
cache:  0.09481599926948547
transfer:  25.391807556152344
forward:  2.5600640773773193
backward:  2.545664072036743
free:  0.2847360074520111
17000
sampling:  0.3389439880847931
gather:  39.54127883911133
cache:  0.0777600035071373
transfer:  25.69820785522461
forward:  2.4988479614257812
backward:  2.4647679328918457
free:  0.3221760094165802
18000
sampling:  0.2714560031890869
gather:  36.54947280883789
cache:  0.6735360026359558
transfer:  23.942176818847656
forward:  2.4933760166168213
backward:  2.7576000690460205
free:  0.34726399183273315
19000
sampling:  0.3418239951133728
gather:  39.241886138916016
cache:  0.15964800119400024
transfer:  22.968191146850586
forward:  2.486207962036133
backward:  2.8334081172943115
free:  0.3067519962787628
20000
sampling:  0.14684799313545227
gather:  37.756065368652344
cache:  0.026784000918269157
transfer:  24.95452880859375
forward:  2.460927963256836
backward:  2.5169920921325684
free:  0.27081599831581116
21000
sampling:  0.16358399391174316
gather:  50.635616302490234
cache:  0.3930560052394867
transfer:  25.873056411743164
forward:  2.509567975997925
backward:  2.3592960834503174
free:  0.26204800605773926
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: False, khop: 10
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
249.1617
266.8510
52.9058
199.9872
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
344.5183
86.5858
5.7642
924.0518
30.7519
531.1661
56.3564
55.9212
149.4234
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0002, Approx. Train: 0.8643
Epoch time: 2524018.1639 ms
