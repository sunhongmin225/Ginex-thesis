Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 3 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 334.5044848918915
Step 1: Done
inspect_time = 352470.65625
Running 1th superbatch of total 3 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 54.78544211387634
[run_ginex.py] pass_1_and_2 time = 54.7855339050293
Pass 3: Computing changesets...
Done!
pass_3 time = 208.6120207309723
[run_ginex.py] pass_3 time = 208.61218237876892
[run_ginex.py] sb_sample time = 375.24415588378906
Step 1: Done
inspect_time = 461389.0625
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.0950080007314682
gather:  215.30979919433594
cache:  0.038495998829603195
transfer:  175.79708862304688
forward:  259.2597961425781
backward:  202.35877990722656
free:  13.888895988464355
1000
sampling:  0.2268799990415573
gather:  125.58000183105469
cache:  0.08611200004816055
transfer:  29.721471786499023
forward:  2.318176031112671
backward:  1.6302399635314941
free:  0.1934719979763031
2000
sampling:  0.16179199516773224
gather:  74.02022552490234
cache:  0.12345600128173828
transfer:  26.367584228515625
forward:  2.346911907196045
backward:  1.9988160133361816
free:  0.22022399306297302
3000
sampling:  0.21702399849891663
gather:  91.13404846191406
cache:  0.06176000088453293
transfer:  26.623455047607422
forward:  2.3601601123809814
backward:  1.801184058189392
free:  0.2404160052537918
4000
sampling:  0.25331199169158936
gather:  94.5350112915039
cache:  0.05459199845790863
transfer:  29.086912155151367
forward:  2.3950400352478027
backward:  1.4018880128860474
free:  0.1884479969739914
5000
sampling:  0.21756799519062042
gather:  84.36300659179688
cache:  0.05567999929189682
transfer:  29.073888778686523
forward:  2.399712085723877
backward:  1.93123197555542
free:  0.25097599625587463
6000
sampling:  0.21379199624061584
gather:  88.82511901855469
cache:  0.08483199775218964
transfer:  29.19772720336914
forward:  2.3815999031066895
backward:  1.9158719778060913
free:  0.265855997800827
7000
sampling:  0.13171200454235077
gather:  91.77699279785156
cache:  0.06496000289916992
transfer:  26.48419189453125
forward:  2.409759998321533
backward:  2.9818880558013916
free:  0.26819199323654175
8000
sampling:  0.19782400131225586
gather:  88.80358123779297
cache:  0.12601600587368011
transfer:  31.454816818237305
forward:  2.3927359580993652
backward:  1.7428799867630005
free:  0.24380800127983093
9000
sampling:  0.37004798650741577
gather:  93.38841247558594
cache:  0.6820160150527954
transfer:  27.567935943603516
forward:  2.3853759765625
backward:  2.258944034576416
free:  0.2526719868183136
10000
sampling:  0.3139840066432953
gather:  85.09180450439453
cache:  0.1268479973077774
transfer:  27.782623291015625
forward:  2.308192014694214
backward:  1.5391039848327637
free:  0.24035200476646423
11000
sampling:  0.27484801411628723
gather:  101.47942352294922
cache:  0.1754239946603775
transfer:  30.923295974731445
forward:  2.400576114654541
backward:  1.9097599983215332
free:  0.2401600033044815
12000
sampling:  0.1565759927034378
gather:  95.08287811279297
cache:  0.09305600076913834
transfer:  29.689952850341797
forward:  2.3898561000823975
backward:  2.143199920654297
free:  0.26473599672317505
13000
sampling:  0.2733440101146698
gather:  102.0533447265625
cache:  0.04163200035691261
transfer:  25.558368682861328
forward:  2.2953600883483887
backward:  1.9128320217132568
free:  0.2024960070848465
14000
sampling:  0.11593600362539291
gather:  86.11872100830078
cache:  0.39184001088142395
transfer:  26.303295135498047
forward:  2.305824041366577
backward:  1.5913280248641968
free:  0.23267200589179993
15000
sampling:  0.25011199712753296
gather:  93.52566528320312
cache:  0.1096000000834465
transfer:  28.408607482910156
forward:  2.3963840007781982
backward:  2.3009281158447266
free:  0.2618879973888397
Step 3: Done
=========================== Total Stat ===========================
dataset: ogbn_papers_extended, sb-size: 16000, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: False, khop: 8
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
334.5
375.2
54.8
208.6
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
461.3891
84.2026
3.5580
1555.9724
65.3330
460.8313
38.6765
32.2356
151.6933
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0001, Approx. Train: 0.3601
Epoch time: 3253622.0450 ms
