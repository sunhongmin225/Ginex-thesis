Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 248.80761551856995
Step 1: Done
inspect_time = 266672.65625
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 51.62957167625427
[run_ginex.py] pass_1_and_2 time = 51.62961506843567
Pass 3: Computing changesets...
Done!
pass_3 time = 517.5767216682434
[run_ginex.py] pass_3 time = 517.5771389007568
[run_ginex.py] sb_sample time = 587.1936445236206
Step 1: Done
inspect_time = 662996.8125
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.09798400104045868
gather:  203.042724609375
cache:  0.03836800158023834
transfer:  178.85586547851562
forward:  324.03143310546875
backward:  209.33938598632812
free:  4.272511959075928
1000
sampling:  0.5326399803161621
gather:  2.8752639293670654
cache:  0.010591999627649784
transfer:  16.543712615966797
forward:  2.2466559410095215
backward:  2.6255359649658203
free:  0.2720319926738739
2000
sampling:  0.2149759978055954
gather:  59.2848014831543
cache:  0.12144000083208084
transfer:  22.678848266601562
forward:  3.398560047149658
backward:  2.521087884902954
free:  0.29407998919487
3000
sampling:  0.30931198596954346
gather:  45.25727844238281
cache:  0.16310399770736694
transfer:  22.72800064086914
forward:  2.7226879596710205
backward:  3.6270079612731934
free:  0.3035840094089508
4000
sampling:  0.14732800424098969
gather:  45.68291091918945
cache:  0.1528639942407608
transfer:  30.810815811157227
forward:  3.205375909805298
backward:  2.4033279418945312
free:  0.22067199647426605
5000
sampling:  0.28303998708724976
gather:  35.331329345703125
cache:  0.29865598678588867
transfer:  23.301855087280273
forward:  2.5641279220581055
backward:  2.9767680168151855
free:  0.3213759958744049
6000
sampling:  0.34537601470947266
gather:  36.9252815246582
cache:  0.03359999880194664
transfer:  30.278079986572266
forward:  2.6748158931732178
backward:  2.2824959754943848
free:  0.21305599808692932
7000
sampling:  0.28143998980522156
gather:  48.06419372558594
cache:  0.07135999947786331
transfer:  22.35468864440918
forward:  3.2767999172210693
backward:  3.329024076461792
free:  0.3283199965953827
8000
sampling:  1.1856640577316284
gather:  39.83078384399414
cache:  0.03446400165557861
transfer:  23.392576217651367
forward:  2.551136016845703
backward:  2.471935987472534
free:  0.2303680032491684
9000
sampling:  0.35152000188827515
gather:  40.65804672241211
cache:  1.1030720472335815
transfer:  33.25120162963867
forward:  2.2923200130462646
backward:  1.8821120262145996
free:  0.3006080090999603
10000
sampling:  0.46320000290870667
gather:  37.18694305419922
cache:  0.05558399856090546
transfer:  21.676544189453125
forward:  2.6781439781188965
backward:  4.544511795043945
free:  0.28883200883865356
11000
sampling:  0.2860479950904846
gather:  50.49702453613281
cache:  0.0915519967675209
transfer:  24.0567684173584
forward:  2.4182400703430176
backward:  2.037760019302368
free:  0.2508159875869751
12000
sampling:  0.5134720206260681
gather:  51.6545295715332
cache:  0.08495999872684479
transfer:  24.84182357788086
forward:  2.439840078353882
backward:  2.017280101776123
free:  0.25513601303100586
13000
sampling:  0.1552640050649643
gather:  50.76268768310547
cache:  0.1188800036907196
transfer:  32.00288009643555
forward:  2.381632089614868
backward:  1.9148800373077393
free:  0.38707199692726135
14000
sampling:  0.25600001215934753
gather:  37.558624267578125
cache:  0.0982080027461052
transfer:  23.320959091186523
forward:  2.7120959758758545
backward:  2.9511680603027344
free:  0.28169599175453186
15000
sampling:  0.2584640085697174
gather:  41.26860809326172
cache:  0.14047999680042267
transfer:  21.57129669189453
forward:  2.7255680561065674
backward:  6.4931840896606445
free:  0.5183039903640747
16000
sampling:  0.27215999364852905
gather:  39.99990463256836
cache:  0.11273600161075592
transfer:  25.067583084106445
forward:  2.4981439113616943
backward:  2.8498239517211914
free:  0.32227200269699097
17000
sampling:  0.4206080138683319
gather:  35.605438232421875
cache:  0.26688000559806824
transfer:  24.428192138671875
forward:  2.5373120307922363
backward:  1.8657280206680298
free:  0.27852800488471985
18000
sampling:  0.23721599578857422
gather:  38.137855529785156
cache:  0.09830400347709656
transfer:  23.84009552001953
forward:  2.5820798873901367
backward:  2.264064073562622
free:  0.26956799626350403
19000
sampling:  0.3386240005493164
gather:  47.34854507446289
cache:  0.225055992603302
transfer:  31.69491195678711
forward:  2.3901760578155518
backward:  2.3746559619903564
free:  0.4551360011100769
20000
sampling:  0.30083200335502625
gather:  43.93036651611328
cache:  0.06054399907588959
transfer:  21.528831481933594
forward:  2.5957438945770264
backward:  5.558271884918213
free:  0.3182399868965149
21000
sampling:  0.22230400145053864
gather:  48.91535949707031
cache:  0.061824001371860504
transfer:  24.40822410583496
forward:  2.524672031402588
backward:  2.5231359004974365
free:  0.2863039970397949
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 4
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
248.8076
587.1936
51.6296
517.5771
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
662.9968
88.2931
5.4244
932.0409
39.2009
514.8576
57.0397
57.0097
134.4008
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0003, Approx. Train: 0.8643
Epoch time: 2838862.8860 ms
