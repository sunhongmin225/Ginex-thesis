Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 3 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 134.11868906021118
Step 1: Done
inspect_time = 151895.578125
Running 1th superbatch of total 3 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 34.420061349868774
[run_ginex.py] pass_1_and_2 time = 34.420135736465454
Pass 3: Computing changesets...
Done!
pass_3 time = 270.384158372879
[run_ginex.py] pass_3 time = 270.38424921035767
[run_ginex.py] sb_sample time = 338.3868248462677
Step 1: Done
inspect_time = 390919.6875
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.10067199915647507
gather:  123.3392333984375
cache:  0.03859199956059456
transfer:  132.47354125976562
forward:  303.00006103515625
backward:  232.7367706298828
free:  11.105728149414062
1000
sampling:  0.06547199934720993
gather:  0.036479998379945755
cache:  0.020160000771284103
transfer:  14.69264030456543
forward:  1.8042880296707153
backward:  2.368511915206909
free:  0.25830399990081787
2000
sampling:  0.1656319946050644
gather:  2.577824115753174
cache:  0.1268800050020218
transfer:  11.343199729919434
forward:  3.4122560024261475
backward:  4.150271892547607
free:  0.47388800978660583
3000
sampling:  0.29574400186538696
gather:  37.385982513427734
cache:  0.09641599655151367
transfer:  13.986592292785645
forward:  2.78108811378479
backward:  3.808255910873413
free:  0.8352320194244385
4000
sampling:  0.3171519935131073
gather:  30.661663055419922
cache:  1.0096319913864136
transfer:  14.326496124267578
forward:  2.7650558948516846
backward:  3.265536069869995
free:  0.31881600618362427
5000
sampling:  0.7773439884185791
gather:  7.439648151397705
cache:  0.01462399959564209
transfer:  8.824383735656738
forward:  1.4700160026550293
backward:  5.082111835479736
free:  0.5446400046348572
6000
sampling:  0.23731200397014618
gather:  24.657855987548828
cache:  0.07251200079917908
transfer:  15.43331241607666
forward:  5.358016014099121
backward:  4.177919864654541
free:  0.3458879888057709
7000
sampling:  0.09974399954080582
gather:  0.04531199857592583
cache:  0.024159999564290047
transfer:  12.770591735839844
forward:  2.3696959018707275
backward:  3.764224052429199
free:  0.3677760064601898
8000
sampling:  0.3701759874820709
gather:  20.592607498168945
cache:  0.05942400172352791
transfer:  13.97321605682373
forward:  5.989727973937988
backward:  4.283391952514648
free:  0.46300798654556274
9000
sampling:  1.2912960052490234
gather:  17.33417510986328
cache:  0.02735999971628189
transfer:  12.297727584838867
forward:  2.459552049636841
backward:  2.431999921798706
free:  0.2602880001068115
10000
sampling:  0.306304007768631
gather:  19.58243179321289
cache:  0.06108799949288368
transfer:  14.596991539001465
forward:  3.0480000972747803
backward:  2.442239999771118
free:  0.29872000217437744
11000
sampling:  0.32236799597740173
gather:  26.072959899902344
cache:  0.09222400188446045
transfer:  15.565247535705566
forward:  2.1088318824768066
backward:  2.4340479373931885
free:  0.4483200013637543
12000
sampling:  0.8535040020942688
gather:  17.357952117919922
cache:  0.019872000440955162
transfer:  10.54867172241211
forward:  1.8254079818725586
backward:  1.714176058769226
free:  0.25231999158859253
13000
sampling:  0.2703680098056793
gather:  23.775808334350586
cache:  0.05804799869656563
transfer:  14.748576164245605
forward:  2.534559965133667
backward:  3.9178240299224854
free:  0.42982399463653564
14000
sampling:  0.26236799359321594
gather:  27.517343521118164
cache:  1.2189120054244995
transfer:  15.825471878051758
forward:  2.7558400630950928
backward:  2.697216033935547
free:  0.2513599991798401
15000
sampling:  0.1409599930047989
gather:  22.902175903320312
cache:  0.7126399874687195
transfer:  9.708352088928223
forward:  1.938048005104065
backward:  8.363007545471191
free:  0.5883200168609619
16000
sampling:  0.6520959734916687
gather:  21.2957763671875
cache:  0.020864000543951988
transfer:  8.967743873596191
forward:  1.5688960552215576
backward:  9.117695808410645
free:  0.6130560040473938
17000
sampling:  1.0505919456481934
gather:  23.02751922607422
cache:  0.026016000658273697
transfer:  19.809951782226562
forward:  3.4887359142303467
backward:  2.9224960803985596
free:  0.3426559865474701
18000
sampling:  0.31865599751472473
gather:  24.693023681640625
cache:  0.15481600165367126
transfer:  14.190239906311035
forward:  3.8499839305877686
backward:  2.519040107727051
free:  0.32556799054145813
19000
sampling:  0.21695999801158905
gather:  25.6147518157959
cache:  0.026240000501275063
transfer:  10.278143882751465
forward:  2.49836802482605
backward:  8.264703750610352
free:  0.5644159913063049
20000
sampling:  0.057792000472545624
gather:  2.4055678844451904
cache:  0.010784000158309937
transfer:  10.490752220153809
forward:  1.6957119703292847
backward:  4.35916805267334
free:  0.5811840295791626
21000
sampling:  0.3073279857635498
gather:  18.913631439208984
cache:  0.9479359984397888
transfer:  12.985952377319336
forward:  4.941472053527832
backward:  3.6136960983276367
free:  0.3494719862937927
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 500, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 8
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
134.1187
338.3868
34.4201
270.3842
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
390.9197
82.7194
5.7083
481.2516
22.9475
309.3696
75.6744
80.0186
85.9033
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0001, Approx. Train: 0.4321
Epoch time: 1761015.9838 ms
