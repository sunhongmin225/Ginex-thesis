Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 249.15489888191223
Step 1: Done
inspect_time = 267038.71875
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 66.938307762146
[run_ginex.py] pass_1_and_2 time = 66.93839240074158
Pass 3: Computing changesets...
Done!
pass_3 time = 147.76601028442383
[run_ginex.py] pass_3 time = 147.76641392707825
[run_ginex.py] sb_sample time = 218.2904372215271
Step 1: Done
inspect_time = 310398.28125
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.09984000027179718
gather:  188.48565673828125
cache:  0.05087999999523163
transfer:  387.655029296875
forward:  372.525634765625
backward:  243.7560272216797
free:  4.322175979614258
1000
sampling:  0.043296001851558685
gather:  0.020864000543951988
cache:  0.012703999876976013
transfer:  20.36012840270996
forward:  2.212383985519409
backward:  1.5523840188980103
free:  0.15110400319099426
2000
sampling:  0.28332799673080444
gather:  63.454368591308594
cache:  0.13542400300502777
transfer:  24.224224090576172
forward:  2.4667201042175293
backward:  4.421631813049316
free:  0.39206400513648987
3000
sampling:  0.1438400000333786
gather:  50.0832633972168
cache:  0.10425599664449692
transfer:  29.023487091064453
forward:  2.8111040592193604
backward:  3.4068479537963867
free:  0.2517760097980499
4000
sampling:  0.32764801383018494
gather:  43.17484664916992
cache:  0.9647039771080017
transfer:  28.815776824951172
forward:  3.4664320945739746
backward:  2.2702078819274902
free:  0.25228801369667053
5000
sampling:  0.23875199258327484
gather:  40.149600982666016
cache:  0.04265600070357323
transfer:  23.040416717529297
forward:  2.6154561042785645
backward:  4.018176078796387
free:  0.35996800661087036
6000
sampling:  0.14127999544143677
gather:  36.720001220703125
cache:  0.8689600229263306
transfer:  19.78508758544922
forward:  2.479871988296509
backward:  2.1729280948638916
free:  0.3141759932041168
7000
sampling:  0.21590399742126465
gather:  46.205345153808594
cache:  0.3056960105895996
transfer:  24.5296630859375
forward:  2.519200086593628
backward:  2.3285439014434814
free:  0.2553919851779938
8000
sampling:  0.09408000111579895
gather:  24.717248916625977
cache:  0.02630399912595749
transfer:  17.59270477294922
forward:  2.3824961185455322
backward:  1.8657280206680298
free:  0.23945599794387817
9000
sampling:  0.23759999871253967
gather:  39.90518569946289
cache:  0.12220799922943115
transfer:  30.07948875427246
forward:  2.407968044281006
backward:  2.1985280513763428
free:  0.22271999716758728
10000
sampling:  0.18774400651454926
gather:  40.56611251831055
cache:  1.1423360109329224
transfer:  23.380128860473633
forward:  2.6355199813842773
backward:  2.4145920276641846
free:  0.35199999809265137
11000
sampling:  0.3684479892253876
gather:  42.66566467285156
cache:  0.8838719725608826
transfer:  24.180511474609375
forward:  2.4690558910369873
backward:  2.3889920711517334
free:  0.30057600140571594
12000
sampling:  0.2316800057888031
gather:  42.72150421142578
cache:  0.07782399654388428
transfer:  25.803136825561523
forward:  2.5012478828430176
backward:  2.7607040405273438
free:  1.1203839778900146
13000
sampling:  0.3271999955177307
gather:  43.22742462158203
cache:  0.14803199470043182
transfer:  29.58086395263672
forward:  2.6409599781036377
backward:  3.1631360054016113
free:  0.3091520071029663
14000
sampling:  0.27587199211120605
gather:  41.97081756591797
cache:  0.11654400080442429
transfer:  26.188512802124023
forward:  2.5014400482177734
backward:  3.142656087875366
free:  0.6584640145301819
15000
sampling:  0.328575998544693
gather:  40.01705551147461
cache:  0.11078400164842606
transfer:  36.40214538574219
forward:  2.4017601013183594
backward:  1.6302080154418945
free:  0.18726399540901184
16000
sampling:  0.1226240023970604
gather:  29.455488204956055
cache:  0.025887999683618546
transfer:  20.960159301757812
forward:  2.6980481147766113
backward:  4.538368225097656
free:  0.5673279762268066
17000
sampling:  0.27980801463127136
gather:  45.196319580078125
cache:  1.187391996383667
transfer:  23.173376083374023
forward:  2.6628799438476562
backward:  3.309567928314209
free:  0.30668801069259644
18000
sampling:  0.41171199083328247
gather:  41.56108856201172
cache:  0.7025600075721741
transfer:  22.291839599609375
forward:  2.5060479640960693
backward:  2.1729280948638916
free:  0.31964799761772156
19000
sampling:  0.27849599719047546
gather:  33.50688171386719
cache:  0.11190400272607803
transfer:  34.36854553222656
forward:  2.4256958961486816
backward:  2.0776960849761963
free:  0.25356799364089966
20000
sampling:  0.4428800046443939
gather:  42.33545684814453
cache:  0.06252799928188324
transfer:  26.497983932495117
forward:  2.4614720344543457
backward:  2.1780478954315186
free:  0.3166080117225647
21000
sampling:  0.24854399263858795
gather:  52.02467346191406
cache:  0.07763200253248215
transfer:  23.376127243041992
forward:  2.7766079902648926
backward:  3.5583999156951904
free:  0.4362559914588928
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 64
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
249.1549
218.2904
66.9384
147.7664
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
310.3983
82.0692
6.4751
942.4581
25.6507
531.0873
57.7730
54.6102
121.9757
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0003, Approx. Train: 0.8643
Epoch time: 2472808.6021 ms
