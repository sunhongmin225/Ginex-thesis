Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 250.70707416534424
Step 1: Done
inspect_time = 268920.78125
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 57.932143688201904
[run_ginex.py] pass_1_and_2 time = 57.93222451210022
Pass 3: Computing changesets...
Done!
pass_3 time = 542.7553813457489
[run_ginex.py] pass_3 time = 542.7558562755585
[run_ginex.py] sb_sample time = 613.616751909256
Step 1: Done
inspect_time = 696867.5
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.10051199793815613
gather:  198.12640380859375
cache:  0.04025600105524063
transfer:  325.2302551269531
forward:  616.932373046875
backward:  243.0003204345703
free:  10.29651165008545
1000
sampling:  0.06764800101518631
gather:  2.453792095184326
cache:  0.012799999676644802
transfer:  7.8534722328186035
forward:  1.7682559490203857
backward:  6.279168128967285
free:  0.44073599576950073
2000
sampling:  5.449120044708252
gather:  0.46143999695777893
cache:  0.018079999834299088
transfer:  7.466207981109619
forward:  1.9268159866333008
backward:  6.361087799072266
free:  0.2517760097980499
3000
sampling:  3.005311965942383
gather:  2.2241599559783936
cache:  0.06332799792289734
transfer:  12.750176429748535
forward:  3.980799913406372
backward:  2.845695972442627
free:  0.3834879994392395
4000
sampling:  0.31884801387786865
gather:  49.98448181152344
cache:  0.08416000008583069
transfer:  13.640607833862305
forward:  2.7136640548706055
backward:  4.013055801391602
free:  0.4119360148906708
5000
sampling:  0.641152024269104
gather:  38.52735900878906
cache:  0.07411199808120728
transfer:  14.9618558883667
forward:  3.1335361003875732
backward:  3.1600639820098877
free:  0.4042240083217621
6000
sampling:  0.29843199253082275
gather:  39.684288024902344
cache:  0.1074879989027977
transfer:  13.277536392211914
forward:  2.46995210647583
backward:  3.8850879669189453
free:  0.3747200071811676
7000
sampling:  0.45263999700546265
gather:  36.20665740966797
cache:  0.18291200697422028
transfer:  11.000096321105957
forward:  2.0902719497680664
backward:  4.923391819000244
free:  0.4434880018234253
8000
sampling:  0.2980479896068573
gather:  33.247806549072266
cache:  0.9325439929962158
transfer:  13.269632339477539
forward:  4.1910400390625
backward:  5.735424041748047
free:  0.3896639943122864
9000
sampling:  0.07168000191450119
gather:  15.68057632446289
cache:  0.013856000266969204
transfer:  9.29366397857666
forward:  2.1089279651641846
backward:  3.131392002105713
free:  0.22633600234985352
10000
sampling:  0.8199359774589539
gather:  7.698624134063721
cache:  0.023455999791622162
transfer:  10.179391860961914
forward:  2.121504068374634
backward:  3.961855888366699
free:  0.2518720030784607
11000
sampling:  0.3033919930458069
gather:  30.83907127380371
cache:  0.07152000069618225
transfer:  14.461312294006348
forward:  2.7680959701538086
backward:  3.097599983215332
free:  0.3359360098838806
12000
sampling:  0.1510079950094223
gather:  24.718687057495117
cache:  0.028095999732613564
transfer:  10.186335563659668
forward:  2.0127360820770264
backward:  7.7485761642456055
free:  0.5937920212745667
13000
sampling:  0.37321600317955017
gather:  26.786399841308594
cache:  0.05724800005555153
transfer:  13.742879867553711
forward:  2.719775915145874
backward:  2.1278719902038574
free:  0.27375999093055725
14000
sampling:  0.09424000233411789
gather:  20.4649600982666
cache:  0.03702399879693985
transfer:  11.279135704040527
forward:  2.4131839275360107
backward:  3.5000319480895996
free:  2.1897599697113037
15000
sampling:  0.2821759879589081
gather:  32.13056182861328
cache:  1.2070080041885376
transfer:  11.762080192565918
forward:  3.2369279861450195
backward:  5.510144233703613
free:  0.5776960253715515
16000
sampling:  0.22412799298763275
gather:  33.10636901855469
cache:  0.08131200075149536
transfer:  13.617535591125488
forward:  2.9576001167297363
backward:  2.4381439685821533
free:  0.2765440046787262
17000
sampling:  0.23286400735378265
gather:  34.99155044555664
cache:  0.09942399710416794
transfer:  11.992223739624023
forward:  2.226464033126831
backward:  5.254144191741943
free:  0.3803519904613495
18000
sampling:  0.24991999566555023
gather:  27.651968002319336
cache:  1.1414719820022583
transfer:  10.972319602966309
forward:  2.5489280223846436
backward:  5.606400012969971
free:  0.4869120121002197
19000
sampling:  0.443231999874115
gather:  29.881664276123047
cache:  0.2840319871902466
transfer:  10.552448272705078
forward:  2.080735921859741
backward:  10.169343948364258
free:  0.479775995016098
20000
sampling:  0.6602240204811096
gather:  27.738208770751953
cache:  0.03699199855327606
transfer:  10.100319862365723
forward:  2.6804161071777344
backward:  3.9966719150543213
free:  0.33155199885368347
21000
sampling:  0.08163200318813324
gather:  8.105600357055664
cache:  0.013824000023305416
transfer:  9.128352165222168
forward:  1.784224033355713
backward:  3.462143898010254
free:  0.5455359816551208
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 8
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
250.7071
613.6168
57.9322
542.7559
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
696.8675
143.7648
8.4275
602.9178
18.5219
282.9049
66.1712
82.7093
79.6026
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0003, Approx. Train: 0.8643
Epoch time: 2328476.9282 ms
