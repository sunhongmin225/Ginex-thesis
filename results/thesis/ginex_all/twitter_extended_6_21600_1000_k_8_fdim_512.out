Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 249.34309005737305
Step 1: Done
inspect_time = 267206.15625
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 51.910717725753784
[run_ginex.py] pass_1_and_2 time = 51.910762310028076
Pass 3: Computing changesets...
Done!
pass_3 time = 156.50183200836182
[run_ginex.py] pass_3 time = 156.50280332565308
[run_ginex.py] sb_sample time = 226.67743968963623
Step 1: Done
inspect_time = 303304.875
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.09728000313043594
gather:  194.3085479736328
cache:  0.04771199822425842
transfer:  287.7423095703125
forward:  466.8541564941406
backward:  176.36659240722656
free:  16.948383331298828
1000
sampling:  0.19075199961662292
gather:  54.59756851196289
cache:  0.10806400328874588
transfer:  41.849246978759766
forward:  3.021696090698242
backward:  1.8063039779663086
free:  0.24182400107383728
2000
sampling:  0.19075199961662292
gather:  51.40390396118164
cache:  0.06201599910855293
transfer:  43.65875244140625
forward:  2.9668478965759277
backward:  1.6578559875488281
free:  0.19033600389957428
3000
sampling:  0.12489599734544754
gather:  30.594175338745117
cache:  0.025312000885605812
transfer:  42.285919189453125
forward:  2.9071359634399414
backward:  1.5964159965515137
free:  0.16512000560760498
4000
sampling:  0.14847999811172485
gather:  46.974815368652344
cache:  0.14748799800872803
transfer:  43.49897766113281
forward:  3.088736057281494
backward:  1.8114559650421143
free:  0.20192000269889832
5000
sampling:  0.12800000607967377
gather:  33.381568908691406
cache:  0.028991999104619026
transfer:  40.6379508972168
forward:  2.8967039585113525
backward:  1.6005120277404785
free:  0.19129599630832672
6000
sampling:  0.17628799378871918
gather:  40.71158218383789
cache:  0.12028799951076508
transfer:  41.89004898071289
forward:  3.0653440952301025
backward:  1.5953919887542725
free:  0.1895039975643158
7000
sampling:  0.3739520013332367
gather:  39.185089111328125
cache:  0.034015998244285583
transfer:  42.398048400878906
forward:  2.9263041019439697
backward:  1.6158720254898071
free:  0.1926400065422058
8000
sampling:  0.19260799884796143
gather:  40.86697769165039
cache:  0.042399998754262924
transfer:  40.663841247558594
forward:  3.127295970916748
backward:  2.029536008834839
free:  0.2316800057888031
9000
sampling:  0.22537599503993988
gather:  37.204830169677734
cache:  0.037728000432252884
transfer:  42.87184143066406
forward:  2.9476161003112793
backward:  1.6250879764556885
free:  0.15347200632095337
10000
sampling:  0.21625599265098572
gather:  53.33769607543945
cache:  0.06185600161552429
transfer:  40.85286331176758
forward:  2.9922239780426025
backward:  1.7715200185775757
free:  0.26284798979759216
11000
sampling:  0.2669120132923126
gather:  52.937278747558594
cache:  0.20652799308300018
transfer:  44.97206497192383
forward:  3.041440010070801
backward:  1.7418240308761597
free:  0.18700799345970154
12000
sampling:  0.13971200585365295
gather:  40.99679946899414
cache:  0.1231359988451004
transfer:  41.23814392089844
forward:  3.0240321159362793
backward:  1.656831979751587
free:  0.1831039935350418
13000
sampling:  0.16047999262809753
gather:  32.8353271484375
cache:  0.01833599992096424
transfer:  43.090110778808594
forward:  2.9675519466400146
backward:  1.6465920209884644
free:  0.18089599907398224
14000
sampling:  0.15254400670528412
gather:  33.09654235839844
cache:  0.024447999894618988
transfer:  35.35935974121094
forward:  3.2741758823394775
backward:  2.5958399772644043
free:  0.2349119931459427
15000
sampling:  0.4028159976005554
gather:  38.18912124633789
cache:  0.033663999289274216
transfer:  42.24748611450195
forward:  2.9218239784240723
backward:  1.614848017692566
free:  0.174112007021904
16000
sampling:  0.2630079984664917
gather:  36.7861442565918
cache:  0.1228799968957901
transfer:  42.482879638671875
forward:  2.9295361042022705
backward:  1.6128000020980835
free:  0.18700799345970154
17000
sampling:  0.2619839906692505
gather:  40.63798522949219
cache:  0.43356800079345703
transfer:  41.60067367553711
forward:  3.021888017654419
backward:  1.719264030456543
free:  0.19577600061893463
18000
sampling:  0.12617599964141846
gather:  40.441505432128906
cache:  0.20444799959659576
transfer:  41.881439208984375
forward:  2.9273600578308105
backward:  1.610751986503601
free:  0.18969599902629852
19000
sampling:  0.347104012966156
gather:  43.32099151611328
cache:  0.04726399853825569
transfer:  42.95232009887695
forward:  3.140255928039551
backward:  1.6506880521774292
free:  0.17561599612236023
20000
sampling:  0.09059199690818787
gather:  41.024864196777344
cache:  0.013887999579310417
transfer:  39.68956756591797
forward:  3.0203518867492676
backward:  1.6373759508132935
free:  0.15910400450229645
21000
sampling:  0.31619200110435486
gather:  40.87251281738281
cache:  0.060256000608205795
transfer:  40.816158294677734
forward:  3.327039957046509
backward:  1.977344036102295
free:  0.23311999440193176
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 8
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
249.3431
226.6774
51.9108
156.5028
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
303.3049
50.7584
7.3265
933.5288
50.3906
922.5054
65.8478
37.4941
215.6538
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0002, Approx. Train: 0.8643
Epoch time: 2916246.0220 ms
