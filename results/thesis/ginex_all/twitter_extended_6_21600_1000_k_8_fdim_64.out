Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 249.57521319389343
Step 1: Done
inspect_time = 269245.53125
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 85.6606855392456
[run_ginex.py] pass_1_and_2 time = 85.6607723236084
Pass 3: Computing changesets...
Done!
pass_3 time = 344.7201292514801
[run_ginex.py] pass_3 time = 344.7204475402832
[run_ginex.py] sb_sample time = 416.3773958683014
Step 1: Done
inspect_time = 527862.8125
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.10038399696350098
gather:  186.99183654785156
cache:  0.04137599840760231
transfer:  197.11766052246094
forward:  458.5893249511719
backward:  174.8275146484375
free:  18.39743995666504
1000
sampling:  11.059967994689941
gather:  0.365119993686676
cache:  0.04700800031423569
transfer:  10.179712295532227
forward:  2.0943360328674316
backward:  3.8410239219665527
free:  0.5080320239067078
2000
sampling:  0.06169600039720535
gather:  0.03891199827194214
cache:  0.02457600086927414
transfer:  6.947199821472168
forward:  1.7927360534667969
backward:  2.8989439010620117
free:  0.35705599188804626
3000
sampling:  0.10035199671983719
gather:  0.15263999998569489
cache:  0.033215999603271484
transfer:  7.033599853515625
forward:  2.084320068359375
backward:  2.4811840057373047
free:  0.32236799597740173
4000
sampling:  0.07772800326347351
gather:  0.03855999931693077
cache:  0.02937600016593933
transfer:  6.0299201011657715
forward:  1.824895977973938
backward:  4.2485761642456055
free:  1.6069120168685913
5000
sampling:  0.08486399799585342
gather:  0.05251200124621391
cache:  0.033824000507593155
transfer:  7.559872150421143
forward:  4.484992027282715
backward:  3.796992063522339
free:  0.450080007314682
6000
sampling:  0.06857600063085556
gather:  0.040800001472234726
cache:  0.025439999997615814
transfer:  5.64521598815918
forward:  1.6375360488891602
backward:  3.3320960998535156
free:  0.3081600069999695
7000
sampling:  0.0586559996008873
gather:  0.03465599939227104
cache:  0.02208000048995018
transfer:  6.216256141662598
forward:  1.9923839569091797
backward:  1.844223976135254
free:  0.23155200481414795
8000
sampling:  0.07635200023651123
gather:  0.04335999861359596
cache:  0.02550400048494339
transfer:  5.447296142578125
forward:  1.6623040437698364
backward:  3.67411208152771
free:  1.22489595413208
9000
sampling:  0.12588800489902496
gather:  0.07580800354480743
cache:  0.05407999828457832
transfer:  7.542272090911865
forward:  2.1905601024627686
backward:  2.8743679523468018
free:  0.2508159875869751
10000
sampling:  0.08012799918651581
gather:  0.04931199923157692
cache:  0.031968001276254654
transfer:  5.751584053039551
forward:  2.4465599060058594
backward:  4.9203200340271
free:  0.476608008146286
11000
sampling:  0.1202239990234375
gather:  0.09545599669218063
cache:  0.042847998440265656
transfer:  6.989823818206787
forward:  2.25052809715271
backward:  4.10316801071167
free:  0.29868799448013306
12000
sampling:  0.07215999811887741
gather:  0.042847998440265656
cache:  0.02812799997627735
transfer:  5.593183994293213
forward:  1.7117120027542114
backward:  5.8122239112854
free:  0.5579519867897034
13000
sampling:  0.08479999750852585
gather:  0.053888000547885895
cache:  0.03526400029659271
transfer:  6.952095985412598
forward:  2.0185599327087402
backward:  2.500607967376709
free:  0.2736639976501465
14000
sampling:  0.25622400641441345
gather:  0.8826239705085754
cache:  0.07718399912118912
transfer:  6.400512218475342
forward:  1.785375952720642
backward:  3.8799359798431396
free:  0.4914880096912384
15000
sampling:  0.09920000284910202
gather:  0.05459199845790863
cache:  0.03484800085425377
transfer:  8.03980827331543
forward:  2.3744959831237793
backward:  2.2620160579681396
free:  0.506496012210846
16000
sampling:  0.09344000369310379
gather:  0.08716800063848495
cache:  0.03590400144457817
transfer:  7.51475191116333
forward:  4.424032211303711
backward:  3.7570559978485107
free:  0.5072640180587769
17000
sampling:  0.06732799857854843
gather:  0.04342399910092354
cache:  0.02486399933695793
transfer:  5.738592147827148
forward:  1.9932160377502441
backward:  4.412415981292725
free:  0.48025599122047424
18000
sampling:  0.062144000083208084
gather:  0.04092799872159958
cache:  0.023552000522613525
transfer:  5.421343803405762
forward:  2.8835840225219727
backward:  4.244480133056641
free:  0.8028799891471863
19000
sampling:  0.178847998380661
gather:  17.73151969909668
cache:  1.1129920482635498
transfer:  8.352479934692383
forward:  2.3240959644317627
backward:  5.177343845367432
free:  0.4836159944534302
20000
sampling:  0.22409600019454956
gather:  20.603679656982422
cache:  0.08284799754619598
transfer:  9.119551658630371
forward:  3.474047899246216
backward:  2.830336093902588
free:  0.27929601073265076
21000
sampling:  0.26947200298309326
gather:  18.391807556152344
cache:  0.16515199840068817
transfer:  9.002528190612793
forward:  3.566240072250366
backward:  2.9020159244537354
free:  0.28521600365638733
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 8
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
249.5752
416.3774
85.6608
344.7204
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
527.8628
223.8982
57.1480
87.9954
4.2699
156.9077
65.3507
82.0605
9.4941
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0004, Approx. Train: 0.8643
Epoch time: 1524267.2954 ms
