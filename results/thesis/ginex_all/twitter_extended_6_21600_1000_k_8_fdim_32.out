Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 242.71135306358337
Step 1: Done
inspect_time = 260639.65625
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 89.38815975189209
[run_ginex.py] pass_1_and_2 time = 89.38824462890625
Pass 3: Computing changesets...
Done!
pass_3 time = 316.5329852104187
[run_ginex.py] pass_3 time = 316.53357553482056
[run_ginex.py] sb_sample time = 386.74546551704407
Step 1: Done
inspect_time = 501544.1875
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.08249600231647491
gather:  174.5094757080078
cache:  0.03951999917626381
transfer:  161.177734375
forward:  472.8541259765625
backward:  169.23648071289062
free:  14.868831634521484
1000
sampling:  0.09964799880981445
gather:  0.07017599791288376
cache:  0.04047999903559685
transfer:  4.908415794372559
forward:  3.869152069091797
backward:  4.151264190673828
free:  0.5154240131378174
2000
sampling:  0.06992000341415405
gather:  0.047775998711586
cache:  0.02643200010061264
transfer:  5.2587199211120605
forward:  1.8852159976959229
backward:  2.915328025817871
free:  0.28595200181007385
3000
sampling:  0.12483199685811996
gather:  0.09734400361776352
cache:  0.055296000093221664
transfer:  4.37775993347168
forward:  2.2434239387512207
backward:  3.4068479537963867
free:  0.7911679744720459
4000
sampling:  0.09862399846315384
gather:  0.05612799897789955
cache:  0.03471999987959862
transfer:  4.3730878829956055
forward:  1.7479360103607178
backward:  3.1641600131988525
free:  0.5380480289459229
5000
sampling:  0.08764799684286118
gather:  0.05423999950289726
cache:  0.03468799963593483
transfer:  4.5266242027282715
forward:  2.00927996635437
backward:  4.076543807983398
free:  0.5438399910926819
6000
sampling:  0.06431999802589417
gather:  0.03747199848294258
cache:  0.02380800060927868
transfer:  6.720992088317871
forward:  5.143136024475098
backward:  3.2327680587768555
free:  0.37036800384521484
7000
sampling:  0.08940800279378891
gather:  0.0544000007212162
cache:  0.034591998904943466
transfer:  4.932511806488037
forward:  3.0333759784698486
backward:  3.4498560428619385
free:  0.8800640106201172
8000
sampling:  0.1746239960193634
gather:  3.1591360569000244
cache:  0.041919998824596405
transfer:  4.870240211486816
forward:  2.4692800045013428
backward:  5.768159866333008
free:  0.5795199871063232
9000
sampling:  0.08723200112581253
gather:  0.06108799949288368
cache:  0.03500799834728241
transfer:  4.206111907958984
forward:  4.434879779815674
backward:  3.5583999156951904
free:  0.3516480028629303
10000
sampling:  0.08828800171613693
gather:  0.05644800141453743
cache:  0.034304000437259674
transfer:  5.235392093658447
forward:  3.5257279872894287
backward:  5.448703765869141
free:  0.3728640079498291
11000
sampling:  0.09177599847316742
gather:  0.05507199838757515
cache:  0.03471999987959862
transfer:  4.81385612487793
forward:  2.9412479400634766
backward:  4.31001615524292
free:  0.4604800045490265
12000
sampling:  0.12460800260305405
gather:  0.08799999952316284
cache:  0.04028800129890442
transfer:  4.254303932189941
forward:  5.404895782470703
backward:  5.235712051391602
free:  0.5630080103874207
13000
sampling:  0.08659200370311737
gather:  0.04707200080156326
cache:  0.024639999493956566
transfer:  4.07366418838501
forward:  1.68668794631958
backward:  3.4447360038757324
free:  0.25200000405311584
14000
sampling:  0.13913600146770477
gather:  0.08899199962615967
cache:  0.03920000046491623
transfer:  4.91926383972168
forward:  5.940447807312012
backward:  4.333568096160889
free:  0.37273600697517395
15000
sampling:  0.07311999797821045
gather:  0.0514880008995533
cache:  0.03331200033426285
transfer:  5.337088108062744
forward:  3.7113280296325684
backward:  3.600383996963501
free:  0.496288001537323
16000
sampling:  0.07555200159549713
gather:  0.0530879981815815
cache:  0.028672000393271446
transfer:  4.285952091217041
forward:  1.9137920141220093
backward:  3.240959882736206
free:  0.36265599727630615
17000
sampling:  0.09340800344944
gather:  0.0639680027961731
cache:  0.03388800099492073
transfer:  6.183328151702881
forward:  5.058720111846924
backward:  3.707904100418091
free:  0.4408319890499115
18000
sampling:  0.10764800012111664
gather:  0.11219199746847153
cache:  0.06464000046253204
transfer:  5.021728038787842
forward:  2.7058560848236084
backward:  3.796992063522339
free:  0.5847679972648621
19000
sampling:  0.11644800007343292
gather:  0.07487999647855759
cache:  0.07254400104284286
transfer:  4.577087879180908
forward:  5.6505279541015625
backward:  3.8686718940734863
free:  0.36233600974082947
20000
sampling:  0.07583999633789062
gather:  0.04527999833226204
cache:  0.027744000777602196
transfer:  4.3006720542907715
forward:  1.7628159523010254
backward:  3.719167947769165
free:  0.5573440194129944
21000
sampling:  0.06217600032687187
gather:  0.037151999771595
cache:  0.02223999984562397
transfer:  5.392352104187012
forward:  2.9587199687957764
backward:  4.5793280601501465
free:  0.684607982635498
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 8
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
242.7114
386.7455
89.3882
316.5336
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
501.5442
35.1072
85.9163
32.2212
2.0457
107.4696
69.3738
88.7829
10.6575
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0007, Approx. Train: 0.8642
Epoch time: 1225618.2210 ms
