Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 247.39770913124084
Step 1: Done
inspect_time = 265215.0625
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 52.621941804885864
[run_ginex.py] pass_1_and_2 time = 52.621984243392944
Pass 3: Computing changesets...
Done!
pass_3 time = 220.5706102848053
[run_ginex.py] pass_3 time = 220.57098031044006
[run_ginex.py] sb_sample time = 291.64367866516113
Step 1: Done
inspect_time = 368947.09375
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.09708800166845322
gather:  174.64639282226562
cache:  0.0414079986512661
transfer:  193.36422729492188
forward:  362.05108642578125
backward:  242.32345581054688
free:  20.533920288085938
1000
sampling:  0.35468798875808716
gather:  2.1697919368743896
cache:  0.052960000932216644
transfer:  23.120031356811523
forward:  2.4228479862213135
backward:  2.9480960369110107
free:  0.43027201294898987
2000
sampling:  0.24377599358558655
gather:  53.17251205444336
cache:  0.5916479825973511
transfer:  23.903871536254883
forward:  2.448960065841675
backward:  2.870271921157837
free:  0.3631359934806824
3000
sampling:  0.26339200139045715
gather:  43.738304138183594
cache:  0.2977280020713806
transfer:  30.055904388427734
forward:  2.8092479705810547
backward:  2.8917760848999023
free:  0.30799999833106995
4000
sampling:  0.2796800136566162
gather:  39.51939010620117
cache:  1.1351039409637451
transfer:  25.028127670288086
forward:  2.343071937561035
backward:  1.5697920322418213
free:  0.22259199619293213
5000
sampling:  0.16950400173664093
gather:  42.277950286865234
cache:  0.4891200065612793
transfer:  22.635583877563477
forward:  2.5050880908966064
backward:  3.568608045578003
free:  0.32387199997901917
6000
sampling:  0.7856960296630859
gather:  31.686752319335938
cache:  0.033440001308918
transfer:  21.09119987487793
forward:  4.991136074066162
backward:  2.1227519512176514
free:  0.2327360063791275
7000
sampling:  0.5904960036277771
gather:  43.77030563354492
cache:  0.07542400062084198
transfer:  23.610048294067383
forward:  2.6595520973205566
backward:  3.176448106765747
free:  0.33852800726890564
8000
sampling:  0.251583993434906
gather:  47.11891174316406
cache:  0.0663359984755516
transfer:  25.309951782226562
forward:  2.457279920578003
backward:  1.7192959785461426
free:  0.23843200504779816
9000
sampling:  0.32179200649261475
gather:  37.41747283935547
cache:  0.06387200206518173
transfer:  25.103424072265625
forward:  2.5135679244995117
backward:  2.791424036026001
free:  0.30697599053382874
10000
sampling:  0.2526719868183136
gather:  38.64815902709961
cache:  0.9782080054283142
transfer:  23.91913604736328
forward:  2.496095895767212
backward:  1.8216960430145264
free:  0.20723199844360352
11000
sampling:  0.2033279985189438
gather:  48.02035140991211
cache:  0.07545600086450577
transfer:  25.508703231811523
forward:  2.439136028289795
backward:  1.7663999795913696
free:  0.25123199820518494
12000
sampling:  0.8560320138931274
gather:  37.27241516113281
cache:  0.04726399853825569
transfer:  23.024511337280273
forward:  2.5040318965911865
backward:  1.8298879861831665
free:  0.2553600072860718
13000
sampling:  0.3073599934577942
gather:  38.74800109863281
cache:  0.2664960026741028
transfer:  24.33558464050293
forward:  2.5106239318847656
backward:  2.442239999771118
free:  0.3346239924430847
14000
sampling:  0.2828480005264282
gather:  46.81459045410156
cache:  0.27164798974990845
transfer:  33.70380783081055
forward:  2.8329920768737793
backward:  1.9804160594940186
free:  0.25407999753952026
15000
sampling:  0.1908160001039505
gather:  36.02096176147461
cache:  0.07555200159549713
transfer:  22.372608184814453
forward:  2.7914559841156006
backward:  3.4017279148101807
free:  0.4041599929332733
16000
sampling:  0.29180800914764404
gather:  41.34009552001953
cache:  0.7714239954948425
transfer:  23.85820770263672
forward:  2.5080320835113525
backward:  2.796544075012207
free:  0.3741439878940582
17000
sampling:  0.2807359993457794
gather:  41.621150970458984
cache:  0.2009280025959015
transfer:  23.83420753479004
forward:  2.4824318885803223
backward:  2.5231359004974365
free:  0.31808000802993774
18000
sampling:  1.0337599515914917
gather:  35.51510238647461
cache:  0.03324799984693527
transfer:  22.12460708618164
forward:  2.5752320289611816
backward:  2.9132800102233887
free:  0.4037120044231415
19000
sampling:  0.3259519934654236
gather:  38.51612854003906
cache:  0.04902400076389313
transfer:  23.487232208251953
forward:  2.590912103652954
backward:  1.99782395362854
free:  0.2595840096473694
20000
sampling:  0.2008959949016571
gather:  48.00614547729492
cache:  0.07894399762153625
transfer:  23.163040161132812
forward:  2.665760040283203
backward:  4.118527889251709
free:  0.3988479971885681
21000
sampling:  0.5158399939537048
gather:  42.81692886352539
cache:  0.05801599845290184
transfer:  30.582271575927734
forward:  2.4921600818634033
backward:  2.045952081680298
free:  0.2648639976978302
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 8
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
247.3977
291.6437
52.6220
220.5710
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
368.9471
89.2097
5.7223
927.2366
32.1485
530.9480
56.7215
56.5131
144.8885
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0002, Approx. Train: 0.8643
Epoch time: 2551272.8221 ms
