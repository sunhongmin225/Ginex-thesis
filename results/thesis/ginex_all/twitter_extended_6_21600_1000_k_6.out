Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 247.5917239189148
Step 1: Done
inspect_time = 265487.09375
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 52.33569812774658
[run_ginex.py] pass_1_and_2 time = 52.33578395843506
Pass 3: Computing changesets...
Done!
pass_3 time = 255.12717151641846
[run_ginex.py] pass_3 time = 255.12777495384216
[run_ginex.py] sb_sample time = 325.53435611724854
Step 1: Done
inspect_time = 402600.96875
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.08764799684286118
gather:  190.4536590576172
cache:  0.04950400069355965
transfer:  214.66928100585938
forward:  323.3154602050781
backward:  218.68646240234375
free:  14.875712394714355
1000
sampling:  0.03302399814128876
gather:  0.024800000712275505
cache:  0.010080000385642052
transfer:  24.184223175048828
forward:  1.9968639612197876
backward:  1.1857919692993164
free:  0.15199999511241913
2000
sampling:  0.3787519931793213
gather:  56.832191467285156
cache:  0.11641599982976913
transfer:  26.06697654724121
forward:  2.5542080402374268
backward:  1.968127965927124
free:  0.2898879945278168
3000
sampling:  0.9305920004844666
gather:  43.52080154418945
cache:  0.053247999399900436
transfer:  21.621919631958008
forward:  2.786303997039795
backward:  2.199552059173584
free:  0.31625598669052124
4000
sampling:  0.31407999992370605
gather:  47.281982421875
cache:  0.09612800180912018
transfer:  25.772031784057617
forward:  2.425600051879883
backward:  2.086911916732788
free:  0.24771200120449066
5000
sampling:  0.14998400211334229
gather:  41.49718475341797
cache:  0.13731199502944946
transfer:  25.16080093383789
forward:  2.3766400814056396
backward:  1.6732159852981567
free:  0.23836800456047058
6000
sampling:  1.2216960191726685
gather:  32.55721664428711
cache:  0.02630399912595749
transfer:  22.209951400756836
forward:  2.3393280506134033
backward:  1.8903039693832397
free:  0.21833600103855133
7000
sampling:  0.2337920069694519
gather:  39.436767578125
cache:  0.16147199273109436
transfer:  23.839519500732422
forward:  2.590912103652954
backward:  3.931135892868042
free:  0.38579198718070984
8000
sampling:  0.27510398626327515
gather:  46.179168701171875
cache:  0.10188800096511841
transfer:  22.168479919433594
forward:  2.5145599842071533
backward:  6.024191856384277
free:  0.7682560086250305
9000
sampling:  0.14547200500965118
gather:  41.72195053100586
cache:  0.09536000341176987
transfer:  25.792095184326172
forward:  2.4916799068450928
backward:  1.9159040451049805
free:  0.2706559896469116
10000
sampling:  0.25119999051094055
gather:  38.85014343261719
cache:  1.003167986869812
transfer:  33.317535400390625
forward:  3.1636159420013428
backward:  2.10534405708313
free:  0.2874560058116913
11000
sampling:  0.30460798740386963
gather:  49.67068862915039
cache:  0.9538559913635254
transfer:  24.429567337036133
forward:  2.5691840648651123
backward:  2.9378559589385986
free:  0.25913599133491516
12000
sampling:  0.19276799261569977
gather:  37.42998504638672
cache:  0.826304018497467
transfer:  22.628992080688477
forward:  2.5355520248413086
backward:  3.876863956451416
free:  0.3222399950027466
13000
sampling:  0.2690240144729614
gather:  47.42051315307617
cache:  0.107744000852108
transfer:  26.894176483154297
forward:  2.7475199699401855
backward:  2.8682239055633545
free:  0.3528960049152374
14000
sampling:  1.004256010055542
gather:  44.45267105102539
cache:  0.03308799862861633
transfer:  25.80748748779297
forward:  2.382783889770508
backward:  2.0848639011383057
free:  0.2447039932012558
15000
sampling:  0.2802560031414032
gather:  41.82307052612305
cache:  0.07635200023651123
transfer:  23.193952560424805
forward:  2.4765119552612305
backward:  2.7002880573272705
free:  0.28326401114463806
16000
sampling:  0.3035520017147064
gather:  43.76515197753906
cache:  0.0841279998421669
transfer:  34.703582763671875
forward:  2.6296639442443848
backward:  1.652735948562622
free:  0.3917759954929352
17000
sampling:  0.2064639925956726
gather:  46.36457443237305
cache:  0.1268479973077774
transfer:  24.560672760009766
forward:  2.3671040534973145
backward:  2.2415359020233154
free:  0.3004480004310608
18000
sampling:  0.5416319966316223
gather:  36.665409088134766
cache:  0.026528000831604004
transfer:  27.42278480529785
forward:  2.3490560054779053
backward:  1.8595839738845825
free:  0.2194879949092865
19000
sampling:  0.23203200101852417
gather:  36.5432014465332
cache:  0.06304000318050385
transfer:  27.254016876220703
forward:  2.407360076904297
backward:  1.539072036743164
free:  0.331712007522583
20000
sampling:  0.18326400220394135
gather:  42.81129455566406
cache:  0.1276479959487915
transfer:  23.65500831604004
forward:  2.5681281089782715
backward:  3.763200044631958
free:  0.2857919931411743
21000
sampling:  0.9035519957542419
gather:  39.32828903198242
cache:  0.10719999670982361
transfer:  26.345439910888672
forward:  2.56166410446167
backward:  3.151871919631958
free:  0.3503679931163788
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 6
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
247.5917
325.5344
52.3358
255.1278
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
402.6010
87.2982
5.6968
915.1084
34.3583
546.5022
56.0962
52.8056
136.9582
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0002, Approx. Train: 0.8643
Epoch time: 2577610.1532 ms
