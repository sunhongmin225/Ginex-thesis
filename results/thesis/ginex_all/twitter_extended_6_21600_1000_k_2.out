Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 249.26914834976196
Step 1: Done
inspect_time = 267126.0
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 50.389628410339355
[run_ginex.py] pass_1_and_2 time = 50.389676332473755
Pass 3: Computing changesets...
Done!
pass_3 time = 654.2644910812378
[run_ginex.py] pass_3 time = 654.2647931575775
[run_ginex.py] sb_sample time = 724.11301445961
Step 1: Done
inspect_time = 799079.125
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.06956800073385239
gather:  215.61830139160156
cache:  0.026528000831604004
transfer:  193.6182403564453
forward:  315.2511291503906
backward:  209.46739196777344
free:  5.012479782104492
1000
sampling:  0.07667200267314911
gather:  2.819103956222534
cache:  0.019680000841617584
transfer:  14.32156753540039
forward:  1.9185600280761719
backward:  8.463423728942871
free:  0.34095999598503113
2000
sampling:  0.30563199520111084
gather:  57.059326171875
cache:  0.16809600591659546
transfer:  26.061952590942383
forward:  2.506432056427002
backward:  2.6408960819244385
free:  0.2486719936132431
3000
sampling:  0.3761279881000519
gather:  45.39731216430664
cache:  0.7048320174217224
transfer:  22.974559783935547
forward:  2.551039934158325
backward:  2.8703041076660156
free:  0.3367359936237335
4000
sampling:  0.2824000120162964
gather:  42.157440185546875
cache:  0.0851840004324913
transfer:  24.393823623657227
forward:  2.5480639934539795
backward:  1.9998719692230225
free:  0.3004159927368164
5000
sampling:  0.31625598669052124
gather:  42.179649353027344
cache:  1.2029119729995728
transfer:  22.256704330444336
forward:  3.4211840629577637
backward:  7.126016139984131
free:  0.4200960099697113
6000
sampling:  0.1284160017967224
gather:  36.925376892089844
cache:  0.06022400036454201
transfer:  20.4748477935791
forward:  2.5084800720214844
backward:  2.0684800148010254
free:  0.3056640028953552
7000
sampling:  0.2903999984264374
gather:  52.0162239074707
cache:  0.8364800214767456
transfer:  22.811359405517578
forward:  2.6618239879608154
backward:  2.802687883377075
free:  0.30000001192092896
8000
sampling:  0.2747200131416321
gather:  50.031551361083984
cache:  0.09529600292444229
transfer:  24.621023178100586
forward:  2.548448085784912
backward:  4.158463954925537
free:  0.6241599917411804
9000
sampling:  0.439520001411438
gather:  34.66156768798828
cache:  0.9420160055160522
transfer:  23.332351684570312
forward:  2.437311887741089
backward:  2.257920026779175
free:  0.298335999250412
10000
sampling:  0.33926400542259216
gather:  43.178016662597656
cache:  0.07769600301980972
transfer:  22.4466552734375
forward:  2.573184013366699
backward:  3.0709760189056396
free:  0.31648001074790955
11000
sampling:  0.13359999656677246
gather:  47.656673431396484
cache:  0.04371200129389763
transfer:  23.39081573486328
forward:  2.44867205619812
backward:  2.387968063354492
free:  0.2850559949874878
12000
sampling:  0.1615999937057495
gather:  36.394718170166016
cache:  0.036288000643253326
transfer:  27.005695343017578
forward:  2.493151903152466
backward:  1.5605759620666504
free:  0.23657600581645966
13000
sampling:  0.15532800555229187
gather:  36.02275085449219
cache:  0.02175999991595745
transfer:  23.07632064819336
forward:  2.7392001152038574
backward:  3.6423680782318115
free:  0.8355200290679932
14000
sampling:  0.19891199469566345
gather:  43.311424255371094
cache:  0.11427199840545654
transfer:  23.281503677368164
forward:  2.7676479816436768
backward:  2.475008010864258
free:  0.2815999984741211
15000
sampling:  0.1515199989080429
gather:  33.402400970458984
cache:  0.027488000690937042
transfer:  21.72380828857422
forward:  2.601855993270874
backward:  2.743295907974243
free:  0.3115519881248474
16000
sampling:  0.39507201313972473
gather:  43.34947204589844
cache:  0.31648001074790955
transfer:  24.11248016357422
forward:  2.5178558826446533
backward:  3.052544116973877
free:  0.3928639888763428
17000
sampling:  0.27724799513816833
gather:  42.55446243286133
cache:  0.11030399799346924
transfer:  23.188352584838867
forward:  2.4578239917755127
backward:  2.362368106842041
free:  0.289247989654541
18000
sampling:  0.17958399653434753
gather:  44.28092956542969
cache:  0.13260799646377563
transfer:  22.41049575805664
forward:  3.53603196144104
backward:  3.843071937561035
free:  0.37913599610328674
19000
sampling:  0.3285120129585266
gather:  39.84329605102539
cache:  0.16655999422073364
transfer:  24.79315185546875
forward:  2.346560001373291
backward:  1.5615999698638916
free:  0.2200320065021515
20000
sampling:  0.17868800461292267
gather:  44.67350387573242
cache:  0.12051200121641159
transfer:  24.62860870361328
forward:  2.4712319374084473
backward:  2.2231040000915527
free:  0.30185601115226746
21000
sampling:  0.23119999468326569
gather:  40.45654296875
cache:  0.15353600680828094
transfer:  24.60371208190918
forward:  2.41158390045166
backward:  1.9445760250091553
free:  0.2632319927215576
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 2
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
249.2691
724.1130
50.3897
654.2648
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
799.0791
89.1097
5.0913
927.7866
49.7093
508.9189
56.3231
55.1663
130.3976
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0002, Approx. Train: 0.8643
Epoch time: 2983208.4510 ms
