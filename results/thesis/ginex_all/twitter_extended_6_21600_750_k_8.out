Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 189.44985842704773
Step 1: Done
inspect_time = 207278.265625
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 43.35734844207764
[run_ginex.py] pass_1_and_2 time = 43.357422828674316
Pass 3: Computing changesets...
Done!
pass_3 time = 276.2129325866699
[run_ginex.py] pass_3 time = 276.21324586868286
[run_ginex.py] sb_sample time = 353.87933349609375
Step 1: Done
inspect_time = 417167.375
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.0843840017914772
gather:  171.08384704589844
cache:  0.039712000638246536
transfer:  166.9686737060547
forward:  317.9251403808594
backward:  199.7557830810547
free:  5.812895774841309
1000
sampling:  0.09734400361776352
gather:  0.06934399902820587
cache:  0.025631999596953392
transfer:  16.286399841308594
forward:  2.1048638820648193
backward:  1.6158720254898071
free:  0.17526400089263916
2000
sampling:  0.21456000208854675
gather:  48.28006362915039
cache:  0.14207999408245087
transfer:  17.715456008911133
forward:  2.6374080181121826
backward:  5.138463973999023
free:  0.4392639994621277
3000
sampling:  0.18876799941062927
gather:  48.547489166259766
cache:  0.06252799928188324
transfer:  18.780960083007812
forward:  2.486176013946533
backward:  2.8149759769439697
free:  0.25548800826072693
4000
sampling:  0.5015360116958618
gather:  36.329246520996094
cache:  0.05628800019621849
transfer:  19.77939224243164
forward:  2.6776959896087646
backward:  2.461695909500122
free:  0.28249600529670715
5000
sampling:  0.3405439853668213
gather:  32.92659378051758
cache:  0.14617599546909332
transfer:  26.33839988708496
forward:  2.266752004623413
backward:  2.441215991973877
free:  0.2780799865722656
6000
sampling:  0.5692480206489563
gather:  31.17033576965332
cache:  0.39983999729156494
transfer:  19.468544006347656
forward:  2.575551986694336
backward:  2.838495969772339
free:  0.24831999838352203
7000
sampling:  0.2741119861602783
gather:  27.919967651367188
cache:  0.0719040036201477
transfer:  17.7524471282959
forward:  2.567199945449829
backward:  3.853343963623047
free:  0.4026559889316559
8000
sampling:  0.29283198714256287
gather:  33.91126251220703
cache:  0.062144000083208084
transfer:  17.8338565826416
forward:  2.597248077392578
backward:  3.14572811126709
free:  0.3302080035209656
9000
sampling:  0.19171200692653656
gather:  35.54819107055664
cache:  0.14416000247001648
transfer:  20.057823181152344
forward:  2.327903985977173
backward:  2.5897281169891357
free:  0.32368001341819763
10000
sampling:  0.2630079984664917
gather:  31.352127075195312
cache:  0.07971200346946716
transfer:  22.187328338623047
forward:  4.455935955047607
backward:  3.1375679969787598
free:  0.3293440043926239
11000
sampling:  0.8154240250587463
gather:  27.592159271240234
cache:  0.026944000273942947
transfer:  17.027263641357422
forward:  2.5405120849609375
backward:  7.113728046417236
free:  0.5031039714813232
12000
sampling:  0.39315199851989746
gather:  31.60095977783203
cache:  0.06028800085186958
transfer:  18.389055252075195
forward:  2.541055917739868
backward:  3.214303970336914
free:  0.3125759959220886
13000
sampling:  0.6996480226516724
gather:  26.911680221557617
cache:  0.04095999896526337
transfer:  20.14499282836914
forward:  3.371295928955078
backward:  3.4508800506591797
free:  0.323168009519577
14000
sampling:  0.4856320023536682
gather:  28.486047744750977
cache:  0.07305599749088287
transfer:  20.68556785583496
forward:  3.765439987182617
backward:  4.625376224517822
free:  1.0922240018844604
15000
sampling:  0.1422719955444336
gather:  31.039775848388672
cache:  0.7140480279922485
transfer:  17.345375061035156
forward:  2.306112051010132
backward:  2.443295955657959
free:  0.2704960107803345
16000
sampling:  0.3267520070075989
gather:  31.598976135253906
cache:  0.08448000252246857
transfer:  22.181472778320312
forward:  2.3466238975524902
backward:  2.7299840450286865
free:  0.2580159902572632
17000
sampling:  0.3019520044326782
gather:  33.981441497802734
cache:  0.8180480003356934
transfer:  19.635648727416992
forward:  2.558784008026123
backward:  2.437119960784912
free:  0.29660800099372864
18000
sampling:  0.5977280139923096
gather:  30.68217658996582
cache:  0.03827200084924698
transfer:  18.29007911682129
forward:  2.492863893508911
backward:  2.707456111907959
free:  0.2895359992980957
19000
sampling:  0.6843199729919434
gather:  32.183902740478516
cache:  0.03686400130391121
transfer:  19.404512405395508
forward:  2.289952039718628
backward:  2.4197120666503906
free:  0.3160960078239441
20000
sampling:  0.30483201146125793
gather:  29.2761287689209
cache:  0.0719040036201477
transfer:  18.017824172973633
forward:  2.4880640506744385
backward:  7.203872203826904
free:  0.3806400001049042
21000
sampling:  0.2269120067358017
gather:  33.6668815612793
cache:  0.04227200150489807
transfer:  16.169055938720703
forward:  2.179744005203247
backward:  2.655263900756836
free:  0.29337599873542786
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 740, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 8
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
189.4499
353.8793
43.3574
276.2132
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
417.1674
82.2199
5.6799
709.1324
27.1989
416.6350
59.6375
74.3278
117.9103
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0002, Approx. Train: 0.6396
Epoch time: 2192748.1792 ms
