Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 249.4153275489807
Step 1: Done
inspect_time = 267649.0
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 54.582152366638184
[run_ginex.py] pass_1_and_2 time = 54.582223415374756
Pass 3: Computing changesets...
Done!
pass_3 time = 171.5959506034851
[run_ginex.py] pass_3 time = 171.59633255004883
[run_ginex.py] sb_sample time = 241.71525979042053
Step 1: Done
inspect_time = 321222.0625
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.10768000036478043
gather:  436.85687255859375
cache:  0.043616000562906265
transfer:  150.07040405273438
forward:  267.50433349609375
backward:  217.8928680419922
free:  13.868608474731445
1000
sampling:  0.038656000047922134
gather:  0.01648000068962574
cache:  0.010208000428974628
transfer:  20.89731216430664
forward:  2.032383918762207
backward:  1.2615679502487183
free:  0.14924800395965576
2000
sampling:  0.25577598810195923
gather:  53.522335052490234
cache:  0.1804800033569336
transfer:  23.661983489990234
forward:  2.5598080158233643
backward:  2.62556791305542
free:  0.2879360020160675
3000
sampling:  0.2722559869289398
gather:  57.28508758544922
cache:  0.17609600722789764
transfer:  24.517215728759766
forward:  2.4251201152801514
backward:  2.0254719257354736
free:  0.26739200949668884
4000
sampling:  0.14953599870204926
gather:  38.62947082519531
cache:  0.04047999903559685
transfer:  20.088607788085938
forward:  2.519711971282959
backward:  3.250175952911377
free:  0.28361600637435913
5000
sampling:  0.2871040105819702
gather:  40.84758377075195
cache:  0.11673600226640701
transfer:  24.46303939819336
forward:  2.479583978652954
backward:  2.3716158866882324
free:  0.3124159872531891
6000
sampling:  0.3614720106124878
gather:  27.452512741088867
cache:  0.025919999927282333
transfer:  19.389408111572266
forward:  3.277631998062134
backward:  2.224128007888794
free:  0.26710399985313416
7000
sampling:  0.30326399207115173
gather:  48.65705490112305
cache:  0.14214399456977844
transfer:  29.94483184814453
forward:  3.0751359462738037
backward:  1.9353599548339844
free:  0.25302401185035706
8000
sampling:  0.2881599962711334
gather:  40.985504150390625
cache:  0.1467839926481247
transfer:  23.813695907592773
forward:  2.6763200759887695
backward:  2.0326719284057617
free:  0.2686080038547516
9000
sampling:  0.31167998909950256
gather:  48.506591796875
cache:  0.07280000299215317
transfer:  23.676223754882812
forward:  2.4566400051116943
backward:  1.9250880479812622
free:  0.26470398902893066
10000
sampling:  0.2735680043697357
gather:  32.317535400390625
cache:  0.029888000339269638
transfer:  23.220352172851562
forward:  2.467711925506592
backward:  1.8483200073242188
free:  0.26796799898147583
11000
sampling:  0.28019198775291443
gather:  47.517887115478516
cache:  0.16710400581359863
transfer:  23.856191635131836
forward:  2.501215934753418
backward:  5.913631916046143
free:  0.4036799967288971
12000
sampling:  0.24083200097084045
gather:  44.44316864013672
cache:  0.1985280066728592
transfer:  23.84160041809082
forward:  2.5831680297851562
backward:  2.4678399562835693
free:  0.26159998774528503
13000
sampling:  0.2736639976501465
gather:  46.69820785522461
cache:  0.11340799927711487
transfer:  23.131807327270508
forward:  2.666719913482666
backward:  2.878495931625366
free:  0.3811520040035248
14000
sampling:  0.25859200954437256
gather:  38.91267013549805
cache:  0.029023999348282814
transfer:  19.617887496948242
forward:  2.502784013748169
backward:  2.9214398860931396
free:  0.25753599405288696
15000
sampling:  0.30300799012184143
gather:  42.40166473388672
cache:  0.10809600353240967
transfer:  27.881887435913086
forward:  2.5094079971313477
backward:  2.2732479572296143
free:  0.28441599011421204
16000
sampling:  0.27187201380729675
gather:  38.76243209838867
cache:  0.15593600273132324
transfer:  24.312576293945312
forward:  2.5821759700775146
backward:  1.9886080026626587
free:  0.2987839877605438
17000
sampling:  0.25942400097846985
gather:  44.5382080078125
cache:  0.9164800047874451
transfer:  31.875167846679688
forward:  2.2842559814453125
backward:  1.446943998336792
free:  0.21545599400997162
18000
sampling:  0.30182400345802307
gather:  40.07804870605469
cache:  0.13600000739097595
transfer:  22.327552795410156
forward:  2.5090880393981934
backward:  3.3198399543762207
free:  0.42323198914527893
19000
sampling:  0.24236799776554108
gather:  42.789695739746094
cache:  0.15270400047302246
transfer:  24.019519805908203
forward:  2.5330560207366943
backward:  2.141184091567993
free:  0.2902719974517822
20000
sampling:  0.24288000166416168
gather:  38.8289909362793
cache:  0.21254399418830872
transfer:  24.561311721801758
forward:  3.1901440620422363
backward:  4.946944236755371
free:  0.4030719995498657
21000
sampling:  0.318015992641449
gather:  41.52924728393555
cache:  0.8850880265235901
transfer:  22.375680923461914
forward:  2.665760040283203
backward:  2.601952075958252
free:  0.3007679879665375
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 16
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
249.4153
241.7153
54.5822
171.5963
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
321.2221
85.8597
5.7058
932.0472
28.6536
519.6640
57.5395
57.9669
157.8646
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0003, Approx. Train: 0.8643
Epoch time: 2504757.0419 ms
