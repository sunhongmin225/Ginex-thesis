Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 193.4868984222412
Step 1: Done
inspect_time = 211418.6875
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 39.477330684661865
[run_ginex.py] pass_1_and_2 time = 39.477378368377686
Pass 3: Computing changesets...
Done!
pass_3 time = 252.5716962814331
[run_ginex.py] pass_3 time = 252.57212042808533
[run_ginex.py] sb_sample time = 327.93091583251953
Step 1: Done
inspect_time = 387556.65625
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.09321600198745728
gather:  204.0614013671875
cache:  0.03840000182390213
transfer:  183.72015380859375
forward:  334.68255615234375
backward:  202.2164764404297
free:  8.275199890136719
1000
sampling:  0.06217600032687187
gather:  0.035840000957250595
cache:  0.014240000396966934
transfer:  23.98361587524414
forward:  2.1964800357818604
backward:  2.5067520141601562
free:  0.19791999459266663
2000
sampling:  0.22934399545192719
gather:  60.37641525268555
cache:  1.0000319480895996
transfer:  24.176511764526367
forward:  2.4605441093444824
backward:  2.594815969467163
free:  0.3503359854221344
3000
sampling:  0.4419200122356415
gather:  44.91347122192383
cache:  0.662335991859436
transfer:  24.278656005859375
forward:  2.5382399559020996
backward:  2.5415680408477783
free:  0.3194560110569
4000
sampling:  0.5910400152206421
gather:  43.890846252441406
cache:  0.5945600271224976
transfer:  24.13270378112793
forward:  2.8231360912323
backward:  2.708479881286621
free:  0.33001598715782166
5000
sampling:  0.2343360036611557
gather:  37.46918487548828
cache:  0.05942400172352791
transfer:  21.083744049072266
forward:  2.619744062423706
backward:  2.070528030395508
free:  0.29497599601745605
6000
sampling:  0.7816960215568542
gather:  31.20979118347168
cache:  0.02691200003027916
transfer:  23.8209285736084
forward:  2.4864320755004883
backward:  1.8708479404449463
free:  0.2727999985218048
7000
sampling:  0.17219200730323792
gather:  47.748287200927734
cache:  0.09932799637317657
transfer:  23.728992462158203
forward:  2.5064001083374023
backward:  4.689919948577881
free:  0.335999995470047
8000
sampling:  0.23955200612545013
gather:  46.401153564453125
cache:  0.07052800059318542
transfer:  25.572256088256836
forward:  2.5038719177246094
backward:  3.0269761085510254
free:  0.40755200386047363
9000
sampling:  0.22739200294017792
gather:  47.684513092041016
cache:  0.07519999891519547
transfer:  26.02364730834961
forward:  2.5594239234924316
backward:  2.5384960174560547
free:  0.29471999406814575
10000
sampling:  0.17635199427604675
gather:  40.17366409301758
cache:  0.08591999858617783
transfer:  26.367712020874023
forward:  2.4716479778289795
backward:  1.7868800163269043
free:  0.24160000681877136
11000
sampling:  0.2858560085296631
gather:  45.315391540527344
cache:  0.6076160073280334
transfer:  22.090816497802734
forward:  2.4108800888061523
backward:  2.439136028289795
free:  0.2699519991874695
12000
sampling:  0.26870399713516235
gather:  43.48310470581055
cache:  0.10313600301742554
transfer:  28.183168411254883
forward:  2.600800037384033
backward:  1.884160041809082
free:  0.38819199800491333
13000
sampling:  0.3984000086784363
gather:  44.088863372802734
cache:  0.08726400136947632
transfer:  24.113248825073242
forward:  2.482016086578369
backward:  1.7571519613265991
free:  0.2399359941482544
14000
sampling:  0.11542399972677231
gather:  36.35891342163086
cache:  0.027295999228954315
transfer:  19.80691146850586
forward:  2.3333120346069336
backward:  2.4115519523620605
free:  0.24463999271392822
15000
sampling:  0.2489600032567978
gather:  40.23561477661133
cache:  0.9094399809837341
transfer:  22.719072341918945
forward:  2.4474880695343018
backward:  2.5466558933258057
free:  0.347104012966156
16000
sampling:  0.3213759958744049
gather:  43.70841598510742
cache:  0.06095999851822853
transfer:  25.687776565551758
forward:  2.389695882797241
backward:  1.6773439645767212
free:  0.21084800362586975
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 16200, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 8
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
193.4869
327.9309
39.4774
252.5721
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
387.5567
81.9497
4.2217
693.6839
24.3832
392.4231
42.3690
42.3742
107.3589
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0002, Approx. Train: 0.6482
Epoch time: 2043271.2426 ms
