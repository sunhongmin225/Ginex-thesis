Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 2 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 248.66554999351501
Step 1: Done
inspect_time = 266533.78125
Running 1th superbatch of total 2 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 59.21712040901184
[run_ginex.py] pass_1_and_2 time = 59.217164754867554
Pass 3: Computing changesets...
Done!
pass_3 time = 151.6594033241272
[run_ginex.py] pass_3 time = 151.65984559059143
[run_ginex.py] sb_sample time = 222.22094535827637
Step 1: Done
inspect_time = 306427.46875
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.0984639972448349
gather:  124.65644836425781
cache:  0.03814399987459183
transfer:  212.5301055908203
forward:  281.76129150390625
backward:  192.62669372558594
free:  4.185376167297363
1000
sampling:  0.3786880075931549
gather:  2.6655681133270264
cache:  0.01548799965530634
transfer:  19.81612777709961
forward:  2.1542720794677734
backward:  1.5267839431762695
free:  0.7150400280952454
2000
sampling:  0.34303998947143555
gather:  55.23593521118164
cache:  0.07097599655389786
transfer:  24.477951049804688
forward:  2.446336030960083
backward:  1.9373760223388672
free:  0.2896000146865845
3000
sampling:  0.21359999477863312
gather:  55.01884841918945
cache:  0.0496320016682148
transfer:  24.207712173461914
forward:  2.560544013977051
backward:  2.736128091812134
free:  0.3261759877204895
4000
sampling:  0.15430399775505066
gather:  32.697601318359375
cache:  0.03526400029659271
transfer:  20.700063705444336
forward:  2.7355520725250244
backward:  3.447808027267456
free:  0.4110719859600067
5000
sampling:  0.2659839987754822
gather:  35.98223876953125
cache:  0.1228799968957901
transfer:  24.417343139648438
forward:  2.5050559043884277
backward:  2.288640022277832
free:  0.3404799997806549
6000
sampling:  0.24134400486946106
gather:  37.685760498046875
cache:  0.14982399344444275
transfer:  24.849727630615234
forward:  2.497728109359741
backward:  2.247648000717163
free:  0.5475519895553589
7000
sampling:  0.248416006565094
gather:  56.89651107788086
cache:  1.2428159713745117
transfer:  21.606176376342773
forward:  2.457279920578003
backward:  4.884479999542236
free:  0.26284798979759216
8000
sampling:  0.15094399452209473
gather:  38.62358474731445
cache:  0.028960000723600388
transfer:  25.078176498413086
forward:  2.7346880435943604
backward:  4.078591823577881
free:  0.23628799617290497
9000
sampling:  0.28303998708724976
gather:  44.7916145324707
cache:  0.09440000355243683
transfer:  25.31839942932129
forward:  2.5361599922180176
backward:  2.0500481128692627
free:  0.5039359927177429
10000
sampling:  0.29369598627090454
gather:  37.72915267944336
cache:  0.21222400665283203
transfer:  24.87900733947754
forward:  2.4303998947143555
backward:  1.5083520412445068
free:  0.23878400027751923
11000
sampling:  0.2473600059747696
gather:  45.7891845703125
cache:  1.2655680179595947
transfer:  23.964672088623047
forward:  2.4438400268554688
backward:  2.1565439701080322
free:  0.2805440127849579
12000
sampling:  0.14422400295734406
gather:  38.988670349121094
cache:  0.03513599932193756
transfer:  22.027807235717773
forward:  2.462048053741455
backward:  2.412544012069702
free:  0.27504000067710876
13000
sampling:  0.1664000004529953
gather:  45.545631408691406
cache:  0.08502399921417236
transfer:  23.351295471191406
forward:  2.499648094177246
backward:  2.002943992614746
free:  0.2885439991950989
14000
sampling:  1.0901119709014893
gather:  42.61180877685547
cache:  0.06163199990987778
transfer:  25.93017578125
forward:  2.493407964706421
backward:  3.1354880332946777
free:  0.32047998905181885
15000
sampling:  0.2160319983959198
gather:  48.47715377807617
cache:  0.8258240222930908
transfer:  24.710752487182617
forward:  2.3633599281311035
backward:  1.7223680019378662
free:  0.23398399353027344
16000
sampling:  0.10364799946546555
gather:  32.07030487060547
cache:  0.018719999119639397
transfer:  18.943391799926758
forward:  2.331648111343384
backward:  2.283519983291626
free:  0.2661440074443817
17000
sampling:  0.27212798595428467
gather:  46.20518493652344
cache:  0.1037760004401207
transfer:  25.938400268554688
forward:  2.470720052719116
backward:  3.3556160926818848
free:  0.31116798520088196
18000
sampling:  0.24527999758720398
gather:  39.56576156616211
cache:  0.7075520157814026
transfer:  24.972736358642578
forward:  2.420032024383545
backward:  3.2225279808044434
free:  0.3843519985675812
19000
sampling:  0.3108159899711609
gather:  35.27414321899414
cache:  0.21190400421619415
transfer:  23.43142318725586
forward:  2.411616086959839
backward:  2.130944013595581
free:  0.29407998919487
20000
sampling:  0.14931200444698334
gather:  35.72665786743164
cache:  0.03046399913728237
transfer:  22.386272430419922
forward:  2.557375907897949
backward:  2.6009600162506104
free:  0.2648639976978302
21000
sampling:  0.2736319899559021
gather:  42.389312744140625
cache:  0.0674239993095398
transfer:  23.65532875061035
forward:  2.4231998920440674
backward:  2.4780800342559814
free:  0.37273600697517395
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 1000, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 32
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
248.6655
222.2209
59.2172
151.6598
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
306.4275
83.7021
5.9841
936.2785
27.2840
527.4210
56.9138
55.3242
145.5217
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0002, Approx. Train: 0.8643
Epoch time: 2483879.4360 ms
