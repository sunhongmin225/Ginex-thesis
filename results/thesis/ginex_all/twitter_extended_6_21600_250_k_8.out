Preparing dataset...
Done!

==============================
Running Epoch 0...
Running 0th superbatch of total 5 superbatches
Step 1: Superbatch Sample
[run_ginex.py] sb_sample time = 78.21276092529297
Step 1: Done
inspect_time = 95715.4453125
Running 1th superbatch of total 5 superbatches
Step 1: Superbatch Sample
Loading ids...
Done!
Pass 1: calculating frequency and initial cache indices...
Done!
Pass 2: making two key data structures (iterptr & iters)...
Done!
pass_1_and_2 time = 27.006479501724243
[run_ginex.py] pass_1_and_2 time = 27.006571531295776
Pass 3: Computing changesets...
Done!
pass_3 time = 146.96645760536194
[run_ginex.py] pass_3 time = 146.96654081344604
[run_ginex.py] sb_sample time = 204.287211894989
Step 1: Done
inspect_time = 249227.3125
Step 2: Switch
Step 2: Done
Step 3: Main Loop
0
sampling:  0.0912960022687912
gather:  58.84531021118164
cache:  0.038015998899936676
transfer:  202.56842041015625
forward:  275.96380615234375
backward:  209.1847686767578
free:  12.246944427490234
1000
sampling:  0.06480000168085098
gather:  0.44918400049209595
cache:  0.01408000010997057
transfer:  8.700127601623535
forward:  3.3363521099090576
backward:  3.9782400131225586
free:  0.3261759877204895
2000
sampling:  0.09622400254011154
gather:  0.3596799969673157
cache:  0.017791999503970146
transfer:  5.036032199859619
forward:  1.098304033279419
backward:  2.314239978790283
free:  0.4264639914035797
3000
sampling:  0.11590400338172913
gather:  0.19631999731063843
cache:  0.030112000182271004
transfer:  5.495488166809082
forward:  1.5571199655532837
backward:  3.3413119316101074
free:  0.26105600595474243
4000
sampling:  0.06159999966621399
gather:  0.03248000144958496
cache:  0.017920000478625298
transfer:  5.683680057525635
forward:  1.571328043937683
backward:  5.480447769165039
free:  0.5124480128288269
5000
sampling:  0.04745600000023842
gather:  0.026240000501275063
cache:  0.01065600011497736
transfer:  5.06387186050415
forward:  1.360416054725647
backward:  2.4770560264587402
free:  0.16252799332141876
6000
sampling:  0.32918399572372437
gather:  19.716800689697266
cache:  0.18966400623321533
transfer:  11.854975700378418
forward:  3.6791040897369385
backward:  3.718143939971924
free:  0.32364800572395325
7000
sampling:  1.077247977256775
gather:  13.256383895874023
cache:  0.031136000528931618
transfer:  9.142111778259277
forward:  3.8815360069274902
backward:  3.989504098892212
free:  0.46886399388313293
8000
sampling:  1.4580479860305786
gather:  14.076000213623047
cache:  0.09852799773216248
transfer:  13.54092788696289
forward:  3.022336006164551
backward:  2.401279926300049
free:  0.3262079954147339
9000
sampling:  0.08697599917650223
gather:  0.04473600164055824
cache:  0.024768000468611717
transfer:  6.528736114501953
forward:  1.4399679899215698
backward:  4.830207824707031
free:  0.4273279905319214
10000
sampling:  0.5860480070114136
gather:  8.844544410705566
cache:  0.012959999963641167
transfer:  9.56287956237793
forward:  4.289567947387695
backward:  3.857408046722412
free:  0.3782080113887787
11000
sampling:  0.2961919903755188
gather:  11.696991920471191
cache:  0.07027199864387512
transfer:  12.05129623413086
forward:  4.2218241691589355
backward:  2.525183916091919
free:  0.2797119915485382
12000
sampling:  0.25043201446533203
gather:  12.375871658325195
cache:  0.07807999849319458
transfer:  9.463711738586426
forward:  5.491456031799316
backward:  2.787328004837036
free:  0.2980160117149353
13000
sampling:  0.1982720047235489
gather:  12.606207847595215
cache:  1.2387200593948364
transfer:  11.021151542663574
forward:  2.7436161041259766
backward:  2.6009600162506104
free:  0.27110400795936584
14000
sampling:  0.9768959879875183
gather:  1.285696029663086
cache:  0.015807999297976494
transfer:  9.133184432983398
forward:  5.796031951904297
backward:  2.8968958854675293
free:  0.3221760094165802
15000
sampling:  0.14691199362277985
gather:  12.971487998962402
cache:  0.19420799612998962
transfer:  10.234687805175781
forward:  4.0411200523376465
backward:  2.4975359439849854
free:  0.2688960134983063
16000
sampling:  1.1297279596328735
gather:  9.360511779785156
cache:  0.01679999940097332
transfer:  9.49619197845459
forward:  2.6030399799346924
backward:  2.023423910140991
free:  0.31331199407577515
17000
sampling:  1.2222720384597778
gather:  12.89072036743164
cache:  0.01961600035429001
transfer:  5.845632076263428
forward:  3.274751901626587
backward:  4.483104228973389
free:  0.47247999906539917
18000
sampling:  0.09558399766683578
gather:  10.650495529174805
cache:  0.05859199911355972
transfer:  5.577856063842773
forward:  1.2157440185546875
backward:  5.253119945526123
free:  0.44998401403427124
19000
sampling:  0.35500800609588623
gather:  7.427455902099609
cache:  1.251744031906128
transfer:  13.841119766235352
forward:  2.9324159622192383
backward:  2.6603519916534424
free:  0.30428799986839294
20000
sampling:  0.17478400468826294
gather:  9.58240032196045
cache:  0.05657599866390228
transfer:  8.668000221252441
forward:  4.629439830780029
backward:  2.941920042037964
free:  0.3805760145187378
21000
sampling:  0.23164799809455872
gather:  11.168543815612793
cache:  0.06400000303983688
transfer:  13.362336158752441
forward:  2.665600061416626
backward:  2.8354880809783936
free:  0.3919360041618347
Step 3: Done
=========================== Total Stat ===========================
dataset: twitter_extended_6, sb-size: 21600, batch-size: 250, nc-size: 45.0GB, fc-size: 50.0GB, zstd: True, khop: 8
Part 1: sb_sample_times pass_1_and_2_times pass_3_times
78.2128
204.2872
27.0066
146.9665
==================================================================
Part 2: inspect_time switch_time sampling_time gather_time cache_time transfer_time forward_time backward_time free_time
249.2273
82.8212
6.2243
185.8971
19.6396
199.6386
80.6275
72.9551
53.5693
==================================================================
Current superbatch ended
Epoch 00, Loss: 0.0001, Approx. Train: 0.2161
Epoch time: 1114428.4337 ms
